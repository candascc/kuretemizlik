<!DOCTYPE html>
<html lang="tr" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
        <meta name="csrf-token" content="3a105ef969e8ed449246b6eb664eaff8c38d4137bea5204bf2391332a1317f3d">
    <!-- Cache Control Meta Tags -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <!-- Security headers should be set on the server (Apache/Nginx). Meta CSP is disabled here to avoid blocking CDN scripts/styles in dev. -->
    <!-- <meta http-equiv="Content-Security-Policy" content=""> -->
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=()">
    <meta name="description" content="K├╝re Temizlik - Profesyonel temizlik hizmetleri ve i┼ş takip sistemi">
    <meta name="keywords" content="temizlik, hizmet, i┼ş takip, m├╝┼şteri y├Ânetimi, s├Âzle┼şme">
    <meta name="author" content="K├╝re Temizlik">
    <meta name="theme-color" content="#2563eb">
    <!-- Mobile optimization -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="format-detection" content="telephone=yes">
    
    <!-- SEO Meta Tags -->
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
        <link rel="canonical" href="http://localhost/app/jobs/new">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="K├╝re Temizlik - ─░┼ş Takip Sistemi">
    <meta property="og:description" content="Profesyonel temizlik hizmetleri ve i┼ş takip sistemi">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://localhost/app/jobs/new">
    
    <title>K├╝re Temizlik - ─░┼ş Takip Sistemi</title>
    
    <!-- Favicon - Performance: Added dimensions to prevent layout shift -->
    <link rel="icon" type="image/png" href="/app/assets/img/logokureapp.png" sizes="32x32">
    <link rel="apple-touch-icon" href="/app/assets/img/logokureapp.png" sizes="180x180">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/app/manifest.json">
    
    <!-- Tailwind CSS (config must be defined BEFORE CDN script) -->
    <script>
        // CRITICAL FIX: Wrap in IIFE with unique scope to prevent "already declared" errors
        // This ensures the script can be loaded multiple times without errors
        // Using unique function name to prevent any potential conflicts
        (function initConsoleSuppress_f0f65ae578ee5cc763fe9ddd2919369c() {
            'use strict';
            // Suppress console warnings BEFORE loading Tailwind
            // Check if already initialized to prevent re-initialization
            if (typeof window.__consoleSuppressInitialized === 'undefined') {
                window.__consoleSuppressInitialized = true;
                window.originalWarn = console.warn;
                window.originalError = console.error;
                
                // Override console.warn only once
                console.warn = function(...args) {
                    const message = args.join(' ');
                    if (message.includes('cdn.tailwindcss.com should not be used in production') || 
                        message.includes('tailwindcss.com')) {
                        return;
                    }
                    if (window.originalWarn) {
                        window.originalWarn.apply(console, args);
                    }
                };
                
                // Override console.error only once
                console.error = function(...args) {
                    const message = args.join(' ');
                    if (message.includes('cdn.tailwindcss.com')) {
                        return;
                    }
                    if (window.originalError) {
                        window.originalError.apply(console, args);
                    }
                };
            }
        })();

        // Define Tailwind config BEFORE loading the CDN script (support both globals)
        try { if (typeof tailwind === 'undefined') { window.tailwind = {}; } } catch(e) { window.tailwind = {}; }
        var TW_CONFIG = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        },
                        secondary: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d',
                        },
                        accent: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75',
                        },
                        neutral: {
                            50: '#fafafa',
                            100: '#f5f5f5',
                            200: '#e5e5e5',
                            300: '#d4d4d4',
                            400: '#a3a3a3',
                            500: '#737373',
                            600: '#525252',
                            700: '#404040',
                            800: '#262626',
                            900: '#171717',
                        }
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                        'display': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    fontWeight: {
                        'normal': '400',
                        'medium': '500',
                        'semibold': '600',
                        'bold': '700',
                        'extrabold': '800',
                    },
                    fontSize: {
                        'xs': ['0.75rem', { lineHeight: '1rem', letterSpacing: '0.05em' }],
                        'sm': ['0.875rem', { lineHeight: '1.25rem', letterSpacing: '0.02em' }],
                        'base': ['1rem', { lineHeight: '1.5rem', letterSpacing: '0' }],
                        'lg': ['1.125rem', { lineHeight: '1.75rem', letterSpacing: '-0.01em' }],
                        'xl': ['1.25rem', { lineHeight: '1.75rem', letterSpacing: '-0.02em' }],
                        '2xl': ['1.5rem', { lineHeight: '2rem', letterSpacing: '-0.03em' }],
                        '3xl': ['1.875rem', { lineHeight: '2.25rem', letterSpacing: '-0.04em' }],
                    },
                    spacing: {
                        '18': '4.5rem',
                        '88': '22rem',
                        '128': '32rem',
                    },
                    borderRadius: {
                        'xl': '0.75rem',
                        '2xl': '1rem',
                        '3xl': '1.5rem',
                    },
                    boxShadow: {
                        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
                        'medium': '0 4px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                        'strong': '0 10px 40px -10px rgba(0, 0, 0, 0.15), 0 2px 10px -2px rgba(0, 0, 0, 0.05)',
                        'glow-sm': '0 0 10px rgba(37, 99, 235, 0.15)',
                        'glow-md': '0 0 20px rgba(37, 99, 235, 0.2)',
                        'glow-lg': '0 0 30px rgba(37, 99, 235, 0.25)',
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                        'gradient-conic': 'conic-gradient(from 180deg at 50% 50%, var(--tw-gradient-stops))',
                        'gradient-mesh': 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    },
                    backdropBlur: {
                        'xs': '2px',
                    }
                }
            }
        };
        // Expose for CDN parser
        try { tailwind.config = TW_CONFIG; } catch(e) { /* ignore */ }
        try { window.tailwind.config = TW_CONFIG; } catch(e) { /* ignore */ }
        // Sticky shadow for nav - Optimized with requestAnimationFrame and passive listeners
        // Performance: Moved to IIFE to avoid blocking, but kept in head for early initialization
        (function() {
            function initNavScroll() {
                const navEl = document.querySelector('nav[data-header]');
                if (!navEl) { return; }

                let ticking = false;
                const updateNavState = () => {
                    if (window.scrollY > 24) {
                        navEl.classList.add('is-compact');
                        navEl.style.boxShadow = '0 3px 12px rgba(15, 23, 42, 0.15)';
                    } else {
                        navEl.classList.remove('is-compact');
                        navEl.style.boxShadow = 'none';
                    }
                    ticking = false;
                };

                const onScroll = () => {
                    if (!ticking) {
                        window.requestAnimationFrame(updateNavState);
                        ticking = true;
                    }
                };

                updateNavState();
                window.addEventListener('scroll', onScroll, { passive: true });

                const triggerSearch = () => {
                    if (window.globalSearch && typeof window.globalSearch.open === 'function') {
                        window.globalSearch.open();
                    }
                };

                const searchInput = document.getElementById('header-search-trigger');
                if (searchInput) {
                    const openSearch = (event) => {
                        event.preventDefault();
                        triggerSearch();
                    };
                    ['click', 'focus'].forEach(evt => searchInput.addEventListener(evt, openSearch, { passive: false }));
                    searchInput.addEventListener('keydown', (event) => {
                        if (event.key === 'Enter' || event.key === ' ') {
                            openSearch(event);
                        }
                        if (event.key === 'Escape') {
                            searchInput.blur();
                        }
                    });
                }
            }
            
            // Performance: Initialize on DOMContentLoaded or immediately if DOM already loaded
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initNavScroll);
            } else {
                initNavScroll();
            }
        })();
    </script>
    <!-- Google Fonts - Optimized with font-display: swap for better LCP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"></noscript>
    
    <!-- Preload critical resources -->
            <!-- ===== PRODUCTION FIX: Remove preload for CSS to avoid QUIC errors ===== -->
        <!-- Preload removed for CSS to prevent QUIC protocol errors -->
        <link rel="preload" href="/app/assets/dist/app.bundle.js?v=1763252236" as="script">
        <!-- ===== PRODUCTION FIX: Font preload optional to reduce warnings ===== -->
    <!-- Font preloads removed to reduce console warnings (fonts will still load normally) -->
    
    <!-- Tailwind CSS (Local build - ROUND 23) -->
    <link rel="stylesheet" href="/app/assets/css/tailwind.css?v=1764071502">
    
    <!-- Custom CSS -->
            <link rel="stylesheet" href="/app/assets/dist/app.bundle.css?v=1763252236">
        <link rel="stylesheet" href="/app/assets/css/custom.css?v=1764071502">
        
    <!-- Print CSS -->
        
    <!-- Chart.js - Lazy load only when needed (charts on page) -->
    <script src="/app/assets/vendor/chart.umd.min.js" defer></script>
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.5/dist/cdn.min.js"></script>
    
    <!-- Form Validation CSS -->
    <style>
/* Form Validation Styles */
.field-error {
    @apply text-sm text-red-600 mt-1 flex items-center;
}

.field-error::before {
    content: "ÔÜá ";
    @apply mr-1;
}

.form-hint {
    @apply text-sm text-gray-500 mt-1;
}

/* Error states */
.form-input.border-red-500 {
    @apply border-red-500;
}

.form-input.border-red-500:focus {
    border-color: #ef4444;
    box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.35);
}

.form-input.border-green-500 {
    @apply border-green-500;
}

.form-input.border-green-500:focus {
    border-color: #22c55e;
    box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.35);
}

/* Success checkmark */
.form-group:has(input:not(:invalid):not(:placeholder-shown)) .field-success {
    display: block;
}

.field-success {
    @apply hidden text-green-600 text-sm mt-1 flex items-center;
}

.field-success::before {
    content: "Ô£ô ";
    @apply mr-1 font-bold;
}

/* Required field indicator */
.form-label .required-indicator {
    @apply text-red-500 ml-1;
}

/* Character counter */
.char-counter {
    @apply text-xs text-gray-500 mt-1 text-right;
}

.char-counter.warning {
    @apply text-yellow-600;
}

.char-counter.error {
    @apply text-red-600;
}

/* Loading state for inputs */
.form-input.loading {
    @apply relative;
}

.form-input.loading::after {
    content: "";
    @apply absolute right-3 top-1/2 -translate-y-1/2;
    width: 16px;
    height: 16px;
    border: 2px solid #e5e7eb;
    border-top-color: #2563eb;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Validation icon positions */
.form-group {
    @apply relative;
}

.validation-icon {
    @apply absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none;
}

/* Error icon */
.validation-icon.error {
    @apply text-red-500;
}

/* Success icon */
.validation-icon.success {
    @apply text-green-500;
}
</style>

    
    <!-- Custom JavaScript -->
            <script src="/app/assets/dist/app.bundle.js?v=1763252236" defer></script>
        
    <!-- Inline CSS (Legacy - Continued) -->
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; }
        [x-cloak] { display: none !important; }
        
        nav[data-header] .header-top { transition: padding 0.3s ease; }
        nav[data-header] .logo-title { transition: transform 0.3s ease, font-size 0.3s ease; }
        nav[data-header].is-compact .header-top { padding-top: 0.45rem !important; padding-bottom: 0.45rem !important; }
        nav[data-header].is-compact .logo-title { font-size: 0.95rem; }
        nav[data-header].is-compact .quick-action-btn { padding-top: 0.45rem; padding-bottom: 0.45rem; }

        .quick-action-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.45rem;
            padding: 0.6rem 1.1rem;
            min-height: 44px;
            min-width: 44px;
            border-radius: 9999px;
            background: rgba(255, 255, 255, 0.17);
            border: 1px solid rgba(255, 255, 255, 0.26);
            color: rgba(255, 255, 255, 0.98);
            font-weight: 600;
            letter-spacing: 0.01em;
            transition: all 0.2s ease;
        }

        .quick-action-btn:hover,
        .quick-action-btn:focus {
            background: rgba(255, 255, 255, 0.28);
            color: #ffffff;
            transform: translateY(-1px);
            box-shadow: 0 14px 32px rgba(15, 23, 42, 0.25);
        }

        .quick-action-btn:focus-visible {
            outline: 3px solid rgba(255, 255, 255, 0.65);
            outline-offset: 3px;
        }

        .status-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
            padding: 0.35rem 0.75rem;
            border-radius: 9999px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(15, 23, 42, 0.35);
            backdrop-filter: blur(8px);
            color: rgba(255, 255, 255, 0.96);
            font-weight: 600;
        }

        .footer-status-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            border: 1px solid rgba(15, 23, 42, 0.12);
            background: rgba(15, 23, 42, 0.04);
            color: #0f172a;
            font-weight: 600;
            font-size: 0.75rem;
            letter-spacing: 0.02em;
            line-height: 1.1;
        }

        .dark .footer-status-chip {
            border-color: rgba(148, 163, 184, 0.5);
            background: rgba(148, 163, 184, 0.12);
            color: rgba(226, 232, 240, 0.95);
        }

        footer.footer-container {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
            margin: 0 !important;
            margin-top: auto !important;
            position: relative !important;
            clear: both !important;
            flex-shrink: 0 !important;
            z-index: 1 !important;
        }

        footer.footer-container > .footer-inner {
            width: 100% !important;
            max-width: 100% !important;
            margin-left: 0 !important;
            margin-right: 0 !important;
            padding-left: 0.75rem !important;
            padding-right: 0.75rem !important;
            box-sizing: border-box !important;
        }

        @media (min-width: 640px) {
            footer.footer-container > .footer-inner {
                max-width: 80rem !important;
                margin-left: auto !important;
                margin-right: auto !important;
                padding-left: 1rem !important;
                padding-right: 1rem !important;
            }
        }

        @media (min-width: 1024px) {
            footer.footer-container > .footer-inner {
                padding-left: 2rem !important;
                padding-right: 2rem !important;
            }
        }

        .footer-container .footer-grid {
            width: 100% !important;
            max-width: 100% !important;
            margin-left: 0 !important;
            margin-right: 0 !important;
            box-sizing: border-box !important;
        }

        @media (max-width: 639px) {
            .footer-container .footer-grid {
                gap: 1.5rem !important;
                padding-left: 0 !important;
                padding-right: 0 !important;
            }
            .footer-container .footer-grid > div {
                width: 100% !important;
                max-width: 100% !important;
                margin-left: 0 !important;
                margin-right: 0 !important;
                padding-left: 0 !important;
                padding-right: 0 !important;
            }
        }

        .footer-meta {
            width: 100% !important;
        }

        .footer-metrics .footer-status-chip {
            border-color: rgba(37, 99, 235, 0.35) !important;
            background: rgba(37, 99, 235, 0.12) !important;
            color: rgba(15, 23, 42, 0.95) !important;
        }

        .dark .footer-metrics .footer-status-chip {
            border-color: rgba(148, 163, 184, 0.55) !important;
            background: rgba(148, 163, 184, 0.18) !important;
            color: rgba(226, 232, 240, 0.98) !important;
        }

        .header-search-input {
            box-shadow: inset 0 1px 2px rgba(15, 23, 42, 0.12);
        }

        .header-search-input:hover {
            background: rgba(255, 255, 255, 0.22);
        }

        .module-subnav {
            scrollbar-width: none;
        }

        .module-subnav::-webkit-scrollbar {
            display: none;
        }

        .module-subnav-link {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.4rem 0.75rem;
            border-radius: 9999px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.12);
            color: rgba(255, 255, 255, 0.82);
            white-space: nowrap;
            transition: all 0.2s ease;
        }

        .module-subnav-link:hover {
            background: rgba(255, 255, 255, 0.24);
            color: #ffffff;
        }

        .module-subnav-link.is-active {
            background: #ffffff;
            color: #1d4ed8;
            box-shadow: 0 4px 12px rgba(29, 78, 216, 0.25);
        }

        .module-subnav-link.is-active i {
            color: #1d4ed8;
        }

        .notif-item {
            margin-bottom: 0.5rem;
            border-radius: 0.75rem;
            transition: background 0.2s ease, transform 0.2s ease;
        }

        .notif-item:hover {
            background: rgba(37, 99, 235, 0.08);
            transform: translateY(-1px);
        }

        .notif-pill {
            display: inline-flex;
            align-items: center;
            padding: 0.15rem 0.55rem;
            border-radius: 9999px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            background: rgba(255, 255, 255, 0.85);
            color: #1d4ed8;
        }

        .dark .notif-pill {
            background: rgba(37, 99, 235, 0.2);
            color: #bfdbfe;
        }

        /* Ensure Font Awesome loads properly */
        .fas, .far, .fal, .fad, .fab {
            font-family: "Font Awesome 6 Free", "Font Awesome 6 Pro", "Font Awesome 6 Brands", "FontAwesome" !important;
            font-weight: 900;
            font-style: normal;
            font-variant: normal;
            text-rendering: auto;
            line-height: 1;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .far {
            font-weight: 400;
        }
        .fal {
            font-weight: 300;
        }
        .fab {
            font-family: "Font Awesome 6 Brands", "FontAwesome" !important;
        }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* Flash message animations */
        @keyframes slideInDown { 
            from { 
                opacity: 0; 
                transform: translateY(-20px); 
            } 
            to { 
                opacity: 1; 
                transform: translateY(0); 
            } 
        }
        
        /* Loading states */
        .loading { opacity: 0.6; pointer-events: none; }
        .loading::after { 
            content: ''; 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            width: 20px; 
            height: 20px; 
            margin: -10px 0 0 -10px; 
            border: 2px solid #f3f3f3; 
            border-top: 2px solid #3498db; 
            border-radius: 50%; 
            animation: spin 1s linear infinite; 
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* Form validation */
        .form-error { 
            border-color: #ef4444 !important; 
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }
        .form-success { 
            border-color: #10b981 !important; 
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1) !important;
        }
        
        /* Form field error states */
        .form-error input,
        .form-error select,
        .form-error textarea {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }
        
        /* Form error label */
        .form-error label {
            color: #ef4444 !important;
        }
        
        /* Skeleton loading */
        .skeleton { 
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); 
            background-size: 200% 100%; 
            animation: loading 1.5s infinite; 
        }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        
        /* Dropdown animations */
        .dropdown-enter {
            animation: dropdownFadeIn 0.15s ease-out;
        }
        
        @keyframes dropdownFadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .mobile-stack { flex-direction: column !important; }
            .mobile-full { width: 100% !important; }
            .mobile-text-sm { font-size: 0.875rem !important; }
            .mobile-p-2 { padding: 0.5rem !important; }
            
            /* Prevent horizontal overflow */
            .overflow-x-auto {
                -webkit-overflow-scrolling: touch;
            }
            
            /* Better table responsiveness */
            table {
                min-width: 100%;
            }
            
            /* Calendar mobile improvements */
            .calendar-grid {
                font-size: 0.75rem;
            }
            
            /* Better touch targets */
            button, a {
                min-height: 44px;
                min-width: 44px;
            }
        }
        
        
        /* Touch targets */
        .touch-target { min-height: 44px; min-width: 44px; }
        
        /* Enhanced focus states */
        .focus-ring:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
            border-color: #3b82f6;
        }
        
        .focus-ring-dark:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
            border-color: #3b82f6;
        }
        
        /* Enhanced hover effects */
        .hover-lift:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .hover-scale:hover {
            transform: scale(1.02);
        }
        
        /* Performance optimizations */
        .will-change-transform { will-change: transform; }
        .will-change-opacity { will-change: opacity; }
        
        /* Lazy loading placeholder */
        .lazy-placeholder { 
            background: #f3f4f6; 
            min-height: 200px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        
        /* Typography hierarchy */
        .text-display {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1.2;
            letter-spacing: -0.025em;
        }
        
        .text-heading-1 {
            font-size: 2rem;
            font-weight: 600;
            line-height: 1.3;
            letter-spacing: -0.025em;
        }
        
        .text-heading-2 {
            font-size: 1.5rem;
            font-weight: 600;
            line-height: 1.4;
            letter-spacing: -0.025em;
        }
        
        .text-heading-3 {
            font-size: 1.25rem;
            font-weight: 600;
            line-height: 1.4;
        }
        
        .text-body-large {
            font-size: 1.125rem;
            font-weight: 400;
            line-height: 1.6;
        }
        
        .text-body {
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.6;
        }
        
        .text-body-small {
            font-size: 0.875rem;
            font-weight: 400;
            line-height: 1.5;
        }
        
        .text-caption {
            font-size: 0.75rem;
            font-weight: 500;
            line-height: 1.4;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        /* Custom icon utilities */
        .icon-sm { font-size: 0.875rem; }
        .icon-md { font-size: 1rem; }
        .icon-lg { font-size: 1.25rem; }
        .icon-xl { font-size: 1.5rem; }
        .icon-2xl { font-size: 2rem; }
        
        .icon-primary { color: #3b82f6; }
        .icon-secondary { color: #22c55e; }
        .icon-accent { color: #d946ef; }
        .icon-success { color: #10b981; }
        .icon-warning { color: #f59e0b; }
        .icon-error { color: #ef4444; }
        .icon-gray { color: #6b7280; }
        
        /* Icon animations */
        .icon-spin { animation: spin 1s linear infinite; }
        .icon-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        .icon-bounce { animation: bounce 1s infinite; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: translateY(-25%);
                animation-timing-function: cubic-bezier(0.8,0,1,1);
            }
            50% {
                transform: none;
                animation-timing-function: cubic-bezier(0,0,0.2,1);
            }
        }
        
        /* Text readability improvements */
        .text-readable {
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .text-contrast-high {
            color: #1f2937;
        }
        
        .text-contrast-medium {
            color: #4b5563;
        }
        
        .text-contrast-low {
            color: #6b7280;
        }
        
        
        /* Link readability */
        .link-readable {
            color: #2563eb;
            text-decoration: underline;
            text-underline-offset: 2px;
            text-decoration-thickness: 1px;
        }
        
        .link-readable:hover {
            color: #1d4ed8;
            text-decoration-thickness: 2px;
        }
        
        /* Responsive grid - mobile-first approach */
        .grid.grid-cols-3 {
            display: grid !important;
            grid-template-columns: 1fr !important; /* Mobile: 1 column */
        }
        
        @media (min-width: 640px) {
            .grid.grid-cols-3 {
                grid-template-columns: repeat(2, 1fr) !important; /* Tablet: 2 columns */
            }
        }
        
        @media (min-width: 1024px) {
            .grid.grid-cols-3 {
                grid-template-columns: repeat(3, 1fr) !important; /* Desktop: 3 columns */
            }
        }
        
        .grid.grid-cols-3 > div {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
    </style>
    <style type="text/tailwindcss">
        @layer components {
            .responsive-table {
                @apply overflow-x-auto;
            }

            .responsive-table table {
                @apply min-w-full divide-y divide-gray-200 dark:divide-gray-700;
            }

            .responsive-table th {
                @apply px-3 sm:px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider;
            }

            .responsive-table td {
                @apply px-3 sm:px-6 py-4 whitespace-nowrap text-sm;
            }

            .responsive-table .action-buttons {
                @apply flex space-x-2 sm:space-x-3;
            }

            .responsive-table .action-button {
                @apply p-1 rounded transition-colors duration-150;
            }

            .responsive-form {
                @apply p-4 sm:p-6 rounded-xl shadow-soft border border-gray-200 dark:border-gray-700;
            }

            .responsive-form .form-grid {
                @apply grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4;
            }

            .responsive-form .form-input {
                @apply w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white transition-all duration-200 text-sm;
            }

            .responsive-form .form-input:focus {
                @apply outline-none;
                box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.35);
                border-color: #3b82f6;
            }

            .responsive-form .form-label {
                @apply block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2;
            }

            .responsive-form .form-button {
                @apply w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 bg-primary-600 hover:bg-primary-700 text-white font-semibold rounded-lg shadow-soft hover:shadow-medium transition-all duration-200 text-sm;
            }

            .responsive-form .form-button:focus {
                @apply outline-none;
                box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
            }

            .responsive-card {
                @apply bg-white dark:bg-gray-800 rounded-xl shadow-soft border border-gray-200 dark:border-gray-700 p-4 sm:p-6;
            }

            .responsive-card-header {
                @apply flex items-center mb-4 sm:mb-6;
            }

            .responsive-card-icon {
                @apply flex-shrink-0 p-2 bg-primary-100 dark:bg-primary-900/20 rounded-lg mr-3;
            }

            .responsive-card-title {
                @apply text-lg sm:text-xl font-bold text-gray-900 dark:text-white;
            }

            .responsive-grid {
                @apply grid grid-cols-1 gap-4 sm:gap-6;
            }

            .responsive-grid-2 {
                @apply grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6;
            }

            .responsive-grid-3 {
                @apply grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6;
            }

            .responsive-grid-4 {
                @apply grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6;
            }

            .responsive-text-xs {
                @apply text-xs sm:text-sm;
            }

            .responsive-text-sm {
                @apply text-sm sm:text-base;
            }

            .responsive-text-base {
                @apply text-base sm:text-lg;
            }

            .responsive-text-lg {
                @apply text-lg sm:text-xl;
            }

            .responsive-text-xl {
                @apply text-xl sm:text-2xl;
            }

            .responsive-p {
                @apply p-4 sm:p-6;
            }

            .responsive-px {
                @apply px-3 sm:px-6;
            }

            .responsive-py {
                @apply py-4 sm:py-6;
            }

            .responsive-mb {
                @apply mb-4 sm:mb-6;
            }

            .responsive-mt {
                @apply mt-4 sm:mt-6;
            }

            .responsive-button {
                @apply inline-flex items-center px-4 sm:px-6 py-2 sm:py-3 text-sm font-semibold rounded-lg shadow-soft hover:shadow-medium transition-all duration-200;
            }

            .responsive-button:focus {
                @apply outline-none;
                box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.45);
            }

            .responsive-button-primary {
                @apply responsive-button bg-primary-600 hover:bg-primary-700 text-white;
            }

            .responsive-button-primary:focus {
                box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.55);
            }

            .responsive-button-secondary {
                @apply responsive-button bg-gray-700 hover:bg-gray-800 dark:bg-gray-600 dark:hover:bg-gray-500 text-white;
            }

            .responsive-button-secondary:focus {
                box-shadow: 0 0 0 2px rgba(107, 114, 128, 0.55);
            }

            .responsive-icon {
                @apply text-sm sm:text-base;
            }

            .responsive-icon-sm {
                @apply text-xs sm:text-sm;
            }

            .responsive-icon-lg {
                @apply text-base sm:text-lg;
            }
        }
    </style>
    
    <!-- Dropdown Toggle Script -->
    <script>
        // Global dropdown handler
        window.toggleDropdown = function(name, event) {
            if (event) {
                event.stopPropagation();
                event.preventDefault();
            }
            const dropdown = document.getElementById('dropdown-' + name);
            if (!dropdown) { return false; }
            const isVisible = dropdown.style.display !== 'none' && dropdown.style.display !== '';
            
            // Store original parent reference if not already stored
            if (!dropdown._originalParent) {
                dropdown._originalParent = dropdown.parentElement;
            }
            
            // Close all first
            document.querySelectorAll('[id^="dropdown-"]').forEach(function(el){ 
                el.style.display='none';
                // Return to original parent if moved to body
                if (el._originalParent && el.parentElement === document.body && el._originalParent !== document.body) {
                    el._originalParent.appendChild(el);
                }
            });
            
            if (!isVisible) {
                let button = null;
                if (event && event.target) {
                    button = event.target.closest('button');
                }
                if (!button) {
                    // Fallback to known buttons
                    const idMap = {
                        settings: 'nav-settings',
                        operations: 'nav-operations',
                        reports: 'nav-reports',
                        'management-services': 'nav-management-services',
                        system: 'system-menu-button'
                    };
                    const btnId = idMap[name];
                    if (btnId) { button = document.getElementById(btnId); }
                }
                if (button) {
                    const rect = button.getBoundingClientRect();
                    // Move dropdown to body to escape stacking context issues
                    if (dropdown.parentElement && dropdown.parentElement !== document.body) {
                        document.body.appendChild(dropdown);
                    }
                    
                    // Set initial position
                    dropdown.style.position = 'fixed';
                    dropdown.style.zIndex = '99999';
                    dropdown.style.display = 'block';
                    
                    // Calculate position - for fixed positioning, use getBoundingClientRect() directly (viewport coordinates)
                    let top = rect.bottom + 8; // 8px margin below button
                    let left = rect.left;
                    
                    // Get dropdown dimensions after it's displayed
                    const dropdownRect = dropdown.getBoundingClientRect();
                    const viewportWidth = window.innerWidth;
                    const viewportHeight = window.innerHeight;
                    
                    // Adjust if dropdown goes off right edge - align to right edge of button
                    if (left + dropdownRect.width > viewportWidth) {
                        left = rect.right - dropdownRect.width;
                        // If still off screen, align to viewport right
                        if (left < 0) {
                            left = viewportWidth - dropdownRect.width - 8;
                        }
                    }
                    
                    // Adjust if dropdown goes off bottom edge - show above button instead
                    if (top + dropdownRect.height > viewportHeight) {
                        top = rect.top - dropdownRect.height - 8;
                        // If still off screen, align to viewport top
                        if (top < 0) {
                            top = 8;
                        }
                    }
                    
                    // Adjust if dropdown goes off left edge
                    if (left < 0) {
                        left = 8;
                    }
                    
                    // Apply final position
                    dropdown.style.top = top + 'px';
                    dropdown.style.left = left + 'px';
                } else {
                    dropdown.style.display = 'block';
                }
            } else {
                dropdown.style.display = 'none';
            }
            return false;
        };
        
        // Mobile menu toggle
        window.toggleMobileMenu = function() {
            // Performance: Removed console.log for production
            const menu = document.getElementById('mobile-menu');
            if (menu) {
                const isVisible = menu.style.display !== 'none';
                menu.style.display = isVisible ? 'none' : 'block';
            }
        };
        
        // Dark mode helpers
            function setThemeMode(mode){
                const html = document.documentElement; const body=document.body;
                html.classList.remove('dark'); body.classList.remove('dark');
                if(mode==='dark'){ html.classList.add('dark'); body.classList.add('dark'); }
                localStorage.setItem('themeMode', mode);
                // Update both desktop and mobile icons
                const icon = document.getElementById('dark-mode-icon');
                const iconMobile = document.getElementById('dark-mode-icon-mobile');
                const iconClass = 'fas text-lg ' + (mode==='dark' ? 'fa-sun' : 'fa-moon');
                if(icon){ icon.className = iconClass; }
                if(iconMobile){ iconMobile.className = iconClass; }
            }
            window.toggleDarkMode = function(){
                const cur = localStorage.getItem('themeMode') || 'light';
                const next = cur==='light' ? 'dark' : 'light';
                setThemeMode(next);
            };
        
        // Initialize on DOM ready
        document.addEventListener('DOMContentLoaded', function() {
            // Performance: Removed console.log for production
            
            // Load dark mode from localStorage or system preference
            const stored = localStorage.getItem('themeMode');
            if(stored){ 
                setThemeMode(stored); 
            } else {
                const prefers = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                const initialMode = prefers ? 'dark' : 'light';
                setThemeMode(initialMode);
            }
            
            // Close dropdowns when clicking outside (with delay to avoid immediate closing)
            document.addEventListener('click', function(event) {
                const clickedDropdown = event.target.closest('[id^="dropdown-"]');
                const clickedButton = event.target.closest('[data-dropdown]');
                
                if (!clickedDropdown && !clickedButton) {
                    setTimeout(function() {
                        document.querySelectorAll('[id^="dropdown-"]').forEach(function(el) {
                            el.style.display = 'none';
                        });
                    }, 10);
                }
            });
            
            // Add dropdown-menu class to all dropdown menus
            document.querySelectorAll('[id^="dropdown-"]').forEach(function(el) {
                el.classList.add('dropdown-menu');
            });
        });
    </script>
</head>
<body class="h-full bg-gray-50 dark:bg-gray-900 flex flex-col transition-colors duration-300">
                <nav data-header class="sticky top-0 z-[9998] header-shell bg-gradient-to-r from-primary-600 to-primary-700 mode-operations" style="will-change: transform;">
    <div class="header-top border-b border-white/10">
        <div class="max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 py-4">
                        <div class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between text-white/80 text-[11px] sm:text-xs mb-3">
                <div class="flex flex-wrap items-center gap-2">
                                            <span class="status-chip bg-white/12 border border-white/20 text-white px-2 py-1 rounded-lg">SLA 99.9%</span>
                                            <span class="status-chip bg-white/12 border border-white/20 text-white px-2 py-1 rounded-lg">Yedek: 25.11.2025 14:51</span>
                                            <span class="status-chip bg-white/12 border border-white/20 text-white px-2 py-1 rounded-lg">v1</span>
                                                        </div>
                                <div class="flex flex-wrap items-center gap-2 md:justify-end">
                                                                                            <span class="status-chip inline-flex items-center gap-1 mode-badge hidden sm:inline-flex" id="sb-mode">
                            <i class="fas fa-layer-group text-white/90 text-xs" aria-hidden="true"></i>                            <span>Temizlik Operasyonlar─▒</span>
                        </span>
                                                                                            <span class="status-chip inline-flex items-center gap-1" id="sb-cache">
                            <i class="fas fa-bolt text-white/90 text-xs" aria-hidden="true"></i>                            <span>Cache: ÔÇö</span>
                        </span>
                                                                                            <span class="status-chip inline-flex items-center gap-1" id="sb-db">
                            <i class="fas fa-database text-white/90 text-xs" aria-hidden="true"></i>                            <span>DB: ÔÇö</span>
                        </span>
                                                                                            <span class="status-chip inline-flex items-center gap-1" id="sb-disk">
                            <i class="fas fa-hdd text-white/90 text-xs" aria-hidden="true"></i>                            <span>Disk: ÔÇö</span>
                        </span>
                                                                                            <span class="status-chip inline-flex items-center gap-1" id="sb-queue">
                            <i class="fas fa-tasks text-white/90 text-xs" aria-hidden="true"></i>                            <span>Queue: ÔÇö</span>
                        </span>
                                    </div>
                            </div>
                        <div class="flex flex-col sm:hidden text-white/80 text-[11px] mb-2">
                <div class="flex items-center justify-end gap-2">
                    <!-- Dark Mode Toggle Button (Mobile) -->
                    <button id="dark-mode-toggle-mobile" onclick="toggleDarkMode()" class="inline-flex items-center justify-center p-2 text-white hover:bg-white/15 rounded-lg transition-colors duration-200" title="Karanl─▒k mod" aria-label="Karanl─▒k mod">
                        <i id="dark-mode-icon-mobile" class="fas fa-moon text-lg" aria-hidden="true"></i>
                    </button>
                    
                                        <div class="relative" id="notif-root-mobile">
                        <button id="notif-button-mobile"
                                type="button"
                                class="relative inline-flex items-center justify-center p-2 text-white hover:bg-white/15 rounded-lg transition-colors duration-200 focus:ring-2 focus:ring-white/60 focus:outline-none"
                                title="Bildirimler"
                                aria-label="Bildirimler"
                                aria-haspopup="dialog"
                                aria-expanded="false"
                                aria-controls="notif-menu-mobile">
                            <i class="fas fa-bell text-lg" aria-hidden="true"></i>
                            <span id="notif-badge-mobile" class="absolute -top-1 -right-1 flex items-center justify-center w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full border-2 border-primary-600 ">
                                1                            </span>
                        </button>
                        <div id="notif-menu-mobile"
                             data-variant="mobile"
                             class="notification-panel hidden absolute right-0 mt-3 w-[calc(100vw-1.5rem)] max-w-96 z-[10000]"
                             role="dialog"
                             aria-modal="true"
                             aria-labelledby="notif-title-mobile">
                            <div class="notification-panel__scrim" data-notif-dismiss aria-hidden="true"></div>
                            <div class="notification-panel__backdrop">
                                <div class="notification-panel__border-glow"></div>
                                <div class="notification-panel__header">
                                    <div class="notification-panel__header-content">
                                        <div class="notification-panel__title" id="notif-title-mobile">
                                            <i class="fas fa-bell notification-panel__title-icon"></i>
                                            <span>Bildirimler</span>
                                            <span class="notification-panel__count-badge " id="notif-count-chip-mobile">
                                                1                                            </span>
                                        </div>
                                        <div class="notification-panel__actions">
                                            <button id="notif-mark-all-mobile" type="button" class="notification-panel__action-btn" title="T├╝m├╝n├╝ okundu say">
                                                <i class="fas fa-check-double"></i>
                                            </button>
                                            <button id="notif-mute-mobile" type="button" class="notification-panel__action-btn" title="Sessize al">
                                                <i class="fas fa-volume-mute"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div id="notif-list-mobile" class="notification-panel__list" role="list">
                                                                                                                        
<div class="notification-item notification-item--ops " data-key="jobs:2025-11-25" data-type="ops" data-href="/app/calendar" data-read="false" tabindex="0" role="button">

    <div class="notification-item__glow"></div>

    
    <button class="notification-item__mark-toggle" type="button" data-action="mark-unread" title="Okunmad─▒ olarak i┼şaretle">

        <i class="fas fa-rotate-left"></i>

    </button>

    
    <div class="notification-item__content">

        <div class="notification-item__icon-wrapper">

            <div class="notification-item__icon-bg"></div>

            <i class="fas fa-calendar-check notification-item__icon"></i>

        </div>

        <div class="notification-item__body">

            <div class="notification-item__header">

                
                <span class="notification-item__badge">

                    <span class="notification-item__badge-dot"></span>

                    <span>Yeni</span>

                </span>

                
                <div class="notification-item__title" title="Bug├╝n 75933 randevu var">

                    Bug├╝n 75933 randevu var
                </div>

            </div>

            
        </div>

    </div>

</div>





                                                                                                            </div>
                                <div class="notification-panel__footer">
                                    <a href="/app/notifications" class="notification-panel__footer-link">
                                        <span>T├╝m├╝n├╝ G├Âr</span>
                                        <i class="fas fa-arrow-right"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                                                            <div class="inline-flex items-center bg-white/15 px-3 py-1 rounded-md">
                        <i class="fas fa-user text-white text-xs mr-1" aria-hidden="true"></i>
                        <span class="text-white text-xs">test_operator</span>
                    </div>
                    <a href="/app/logout"
                       class="inline-flex items-center justify-center p-2 bg-white/15 text-white rounded-md hover:bg-white/25 transition-all duration-200"
                       aria-label="├ç─▒k─▒┼ş">
                        <i class="fas fa-sign-out-alt text-xs"></i>
                    </a>
                                    </div>
            </div>

            <div class="grid gap-4 lg:grid-cols-[auto,1fr,auto] items-start lg:items-center">
                <div class="flex items-center gap-3 min-w-0 w-full sm:w-auto">
                    <a href="/app/" class="flex items-center gap-3 group shrink-0" aria-label="K├╝re Temizlik">
                        <!-- Su ye┼şili ve alt─▒n renkli uyumlu gradient border - Logo eksiksiz g├Âr├╝necek, beyaz alan minimize -->
                        <span class="relative inline-flex items-center justify-center rounded-full p-[2px] sm:p-[2.5px] bg-gradient-to-br from-teal-400 via-cyan-400 to-amber-400 shadow-lg ring-2 ring-teal-400/30 transition-all duration-200 group-hover:shadow-xl group-hover:ring-teal-400/50 group-hover:from-teal-500 group-hover:via-cyan-500 group-hover:to-amber-500">
                            <span class="relative h-[5.625rem] w-[5.625rem] sm:h-[6.5625rem] sm:w-[6.5625rem] rounded-full bg-white dark:bg-gray-800 flex items-center justify-center overflow-hidden shadow-[inset_0_0_8px_rgba(0,0,0,0.08),inset_0_0_4px_rgba(20,184,166,0.15)] backdrop-blur-[0.5px]">
                                                                    <!-- Performance: WebP support with fallback -->
                                    <picture>
                                        <source srcset="/app/assets/img/logokureapp.webp?v=1763560138" type="image/webp">
                                        <img src="/app/assets/img/logokureapp.png?v=1763560138" width="32" height="32" alt="K├╝re Temizlik Logosu"
                                             class="h-full w-full object-contain transform origin-center scale-[1.05]"
                                             loading="eager" decoding="async"
                                             style="max-width: 100%; max-height: 100%;filter:drop-shadow(0_0_2px_rgba(0,0,0,0.1));">
                                    </picture>
                                                            </span>
                        </span>
                    </a>
                                        <div class="flex-1 flex justify-end sm:hidden">
                        <div class="inline-flex items-center gap-1 rounded-full border border-white/25 bg-white/10 backdrop-blur-sm p-1 text-[11px] mode-switcher">
                                                                                            <a href="/app/?header_mode=operations"
                                   class="mode-switcher__option is-active"
                                   title="Temizlik planlama, saha y├Ânetimi ve operasyonel mod├╝ller"                                   role="tab"
                                   aria-selected="true">
                                    <span>Operasyon</span>
                                </a>
                                                                                            <a href="/app/management/dashboard?header_mode=management"
                                   class="mode-switcher__option "
                                   title="Apartman, site ve sakin y├Ânetimi mod├╝lleri"                                   role="tab"
                                   aria-selected="false">
                                    <span>Y├Ânetim</span>
                                </a>
                                                    </div>
                    </div>
                                    </div>

                                <div class="flex flex-col gap-3 w-full">
                                        <div class="relative group header-search">
                        <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-white/60"></i>
                        <input id="header-search-trigger"
                               type="search"
                               readonly
                               placeholder="H─▒zl─▒ arama (Ctrl + /)"
                               class="w-full header-search-input pl-11 pr-20 py-2.5 rounded-xl bg-white/15 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 focus:bg-white/20 cursor-pointer transition-all duration-200"
                               aria-label="H─▒zl─▒ arama">
                        <span class="absolute right-4 top-1/2 -translate-y-1/2 text-[10px] uppercase tracking-wider text-white/70 px-2 py-1 bg-white/10 rounded-md border border-white/20">Ctrl + /</span>
                    </div>
                    
                                        <div class="header-actions mt-2">
                        <div class="header-actions__primary quick-actions-row flex flex-wrap items-center gap-2 text-xs sm:text-sm">
                                                                                            <a href="/app/jobs/new" class="quick-action-btn variant-operations">
                                    <i class="fas fa-plus-circle text-xs sm:text-sm"></i>                                    <span>Yeni ─░┼ş</span>
                                </a>
                                                                                            <a href="/app/recurring/new" class="quick-action-btn variant-operations">
                                    <i class="fas fa-redo text-xs sm:text-sm"></i>                                    <span>Periyodik ─░┼ş</span>
                                </a>
                                                    </div>
                                                    <div class="header-actions__secondary mode-switcher hidden sm:inline-flex items-center gap-1 rounded-full border border-white/25 bg-white/10 backdrop-blur-sm p-1 text-xs sm:text-sm">
                                                                                                        <a href="/app/?header_mode=operations"
                                       class="mode-switcher__option is-active"
                                       title="Temizlik planlama, saha y├Ânetimi ve operasyonel mod├╝ller"                                       role="tab"
                                       aria-selected="true">
                                        <i class="fas fa-cogs"></i>                                        <span>Operasyon</span>
                                    </a>
                                                                                                        <a href="/app/management/dashboard?header_mode=management"
                                       class="mode-switcher__option "
                                       title="Apartman, site ve sakin y├Ânetimi mod├╝lleri"                                       role="tab"
                                       aria-selected="false">
                                        <i class="fas fa-city"></i>                                        <span>Y├Ânetim</span>
                                    </a>
                                                            </div>
                                            </div>
                                    </div>
                
                <div class="flex flex-wrap items-center justify-end gap-3 text-white">
                    <div class="flex items-center gap-3 w-full lg:w-auto justify-end order-1 lg:order-none">
                        <!-- Dark Mode Toggle Button (Desktop) -->
                        <button id="dark-mode-toggle" onclick="toggleDarkMode()" class="hidden sm:inline-flex items-center justify-center p-2 text-white hover:bg-white/15 rounded-lg transition-colors duration-200" title="Karanl─▒k mod" aria-label="Karanl─▒k mod">
                            <i id="dark-mode-icon" class="fas fa-moon text-lg" aria-hidden="true"></i>
                        </button>
                        
                                                <div class="relative hidden sm:block" id="notif-root">
                            <button id="notif-button"
                                    type="button"
                                    class="relative inline-flex items-center justify-center p-2 text-white hover:bg-white/15 rounded-lg transition-colors duration-200 focus:ring-2 focus:ring-white/60 focus:outline-none"
                                    title="Bildirimler"
                                    aria-label="Bildirimler"
                                    aria-haspopup="dialog"
                                    aria-expanded="false"
                                    aria-controls="notif-menu">
                                <i class="fas fa-bell text-lg" aria-hidden="true"></i>
                                <span id="notif-badge" class="absolute -top-1 -right-1 flex items-center justify-center w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full border-2 border-primary-600 ">
                                    1                                </span>
                            </button>
                            <div id="notif-menu"
                                 data-variant="desktop"
                                 class="notification-panel hidden absolute right-0 mt-3 w-96 max-w-[calc(100vw-1.5rem)] sm:max-w-96 z-[10000]"
                                 role="dialog"
                                 aria-modal="false"
                                 aria-labelledby="notif-title-desktop">
                                <!-- Glassmorphism backdrop with gradient border -->
                                <div class="notification-panel__scrim" data-notif-dismiss aria-hidden="true"></div>
                                <div class="notification-panel__backdrop">
                                    <!-- Animated gradient border -->
                                    <div class="notification-panel__border-glow"></div>
                                    
                                    <!-- Header -->
                                    <div class="notification-panel__header">
                                        <div class="notification-panel__header-content">
                                            <div class="notification-panel__title" id="notif-title-desktop">
                                                <i class="fas fa-bell notification-panel__title-icon"></i>
                                                <span>Bildirimler</span>
                                                <span class="notification-panel__count-badge " id="notif-count-chip">
                                                    1                                                </span>
                                            </div>
                                            <div class="notification-panel__actions">
                                                <button id="notif-mark-all" type="button" class="notification-panel__action-btn" title="T├╝m├╝n├╝ okundu say">
                                                    <i class="fas fa-check-double"></i>
                                                </button>
                                                <button id="notif-mute" type="button" class="notification-panel__action-btn" title="Sessize al">
                                                    <i class="fas fa-volume-mute"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Notification List -->
                                    <div id="notif-list" class="notification-panel__list" role="list">
                                                                                                                                    
<div class="notification-item notification-item--ops " data-key="jobs:2025-11-25" data-type="ops" data-href="/app/calendar" data-read="false" tabindex="0" role="button">

    <div class="notification-item__glow"></div>

    
    <button class="notification-item__mark-toggle" type="button" data-action="mark-unread" title="Okunmad─▒ olarak i┼şaretle">

        <i class="fas fa-rotate-left"></i>

    </button>

    
    <div class="notification-item__content">

        <div class="notification-item__icon-wrapper">

            <div class="notification-item__icon-bg"></div>

            <i class="fas fa-calendar-check notification-item__icon"></i>

        </div>

        <div class="notification-item__body">

            <div class="notification-item__header">

                
                <span class="notification-item__badge">

                    <span class="notification-item__badge-dot"></span>

                    <span>Yeni</span>

                </span>

                
                <div class="notification-item__title" title="Bug├╝n 75933 randevu var">

                    Bug├╝n 75933 randevu var
                </div>

            </div>

            
        </div>

    </div>

</div>





                                                                                                                        </div>
                                    
                                    <!-- Footer -->
                                    <div class="notification-panel__footer">
                                        <a href="/app/notifications" class="notification-panel__footer-link">
                                            <span>T├╝m├╝n├╝ G├Âr</span>
                                            <i class="fas fa-arrow-right"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        
                                                <div class="hidden sm:flex items-center space-x-2 text-sm">
                            <div class="inline-flex items-center bg-white/15 px-3 py-1 rounded-md">
                                <i class="fas fa-user text-white text-xs mr-1" aria-hidden="true"></i>
                                <span class="text-white">test_operator</span>
                            </div>
                            <a href="/app/logout"
                               class="inline-flex items-center px-3 py-1.5 bg-white/15 hover:bg-white/25 text-white text-sm rounded-md transition-all duration-200"
                               title="├ç─▒k─▒┼ş" aria-label="├ç─▒k─▒┼ş">
                                <i class="fas fa-sign-out-alt mr-1.5 text-xs" aria-hidden="true"></i>
                                <span class="hidden lg:inline">├ç─▒k─▒┼ş</span>
                            </a>
                        </div>
                        
                        
                                            </div>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-3 sm:px-4 lg:px-6" style="position: relative; overflow: visible;">
        <div class="flex items-center justify-between h-14" style="position: relative; overflow: visible;">
            <div class="sm:hidden flex items-center">
                <button onclick="toggleMobileMenu()" 
                        class="text-white hover:bg-white hover:bg-opacity-10 p-2 rounded transition-all duration-200" aria-label="Mobil men├╝y├╝ a├ğ/kapat">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <div class="hidden sm:flex items-center space-x-1 flex-1 overflow-x-auto" style="scrollbar-width: none; -ms-overflow-style: none; overflow-y: visible;">
                <style>.hide-scrollbar::-webkit-scrollbar { display: none; }</style>
                <div class="flex items-center space-x-1 hide-scrollbar" style="overflow: visible;">
                                                                                                                            <a href="/app/"
                               class="text-white hover:bg-white hover:bg-opacity-10 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-all duration-200 flex items-center gap-1.5"
                               aria-current="false">
                                <i class="fas fa-home mr-1"></i>                                Ana                            </a>
                                                                                                                                                    <a href="/app/calendar"
                               class="text-white hover:bg-white hover:bg-opacity-10 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-all duration-200 flex items-center gap-1.5"
                               aria-current="false">
                                <i class="fas fa-calendar mr-1"></i>                                Takvim                            </a>
                                                                                                                                                    <a href="/app/jobs"
                               class="bg-white bg-opacity-20 text-white shadow-inner px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-all duration-200 flex items-center gap-1.5"
                               aria-current="page">
                                <i class="fas fa-tasks mr-1"></i>                                ─░┼şler                            </a>
                                                                                                                                                    <a href="/app/customers"
                               class="text-white hover:bg-white hover:bg-opacity-10 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-all duration-200 flex items-center gap-1.5"
                               aria-current="false">
                                <i class="fas fa-users mr-1"></i>                                M├╝┼şteriler                            </a>
                                                                                                                        <div class="relative" data-dropdown="management" style="z-index: 1000;">
                                <button id="nav-management"
                                        onclick="return window.toggleDropdown('management', event);"
                                        class="text-white hover:bg-white hover:bg-opacity-10 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-all duration-200 flex items-center gap-1.5">
                                    <i class="fas fa-briefcase mr-1"></i>                                    Y├Ânetim                                    <i class="fas fa-chevron-down text-xs"></i>
                                </button>
                                <div id="dropdown-management" style="display: none; position: fixed; z-index: 99999;" class="mt-2 w-64 rounded-lg shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 py-2" onclick="event.stopPropagation();">
                                                                                                                                                                                                                                                                                                                                <a href="/app/ointments"
                                               class="flex items-center gap-2 px-4 py-2 text-sm transition-colors duration-150 text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">
                                                <i class="fas fa-calendar-check w-4 text-primary-500 dark:text-primary-300"></i>                                                <span>Randevular</span>
                                            </a>
                                                                                                                                <a href="/app/staff"
                                               class="flex items-center gap-2 px-4 py-2 text-sm transition-colors duration-150 text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">
                                                <i class="fas fa-user-tie w-4 text-primary-500 dark:text-primary-300"></i>                                                <span>Personel</span>
                                            </a>
                                                                                                            </div>
                            </div>
                                                                                                                        <div class="relative" data-dropdown="operations" style="z-index: 1000;">
                                <button id="nav-operations"
                                        onclick="return window.toggleDropdown('operations', event);"
                                        class="text-white hover:bg-white hover:bg-opacity-10 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-all duration-200 flex items-center gap-1.5">
                                    <i class="fas fa-cogs mr-1"></i>                                    Operasyon                                    <i class="fas fa-chevron-down text-xs"></i>
                                </button>
                                <div id="dropdown-operations" style="display: none; position: fixed; z-index: 99999;" class="mt-2 w-64 rounded-lg shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 py-2" onclick="event.stopPropagation();">
                                                                                                                                                                                                                                                                                                                                <a href="/app/recurring"
                                               class="flex items-center gap-2 px-4 py-2 text-sm transition-colors duration-150 text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">
                                                <i class="fas fa-redo w-4 text-primary-500 dark:text-primary-300"></i>                                                <span>Periyodik</span>
                                            </a>
                                                                                                                                <a href="/app/services"
                                               class="flex items-center gap-2 px-4 py-2 text-sm transition-colors duration-150 text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">
                                                <i class="fas fa-concierge-bell w-4 text-primary-500 dark:text-primary-300"></i>                                                <span>Hizmetler</span>
                                            </a>
                                                                                                            </div>
                            </div>
                                                                                                                        <div class="relative" data-dropdown="reports" style="z-index: 1000;">
                                <button id="nav-reports"
                                        onclick="return window.toggleDropdown('reports', event);"
                                        class="text-white hover:bg-white hover:bg-opacity-10 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-all duration-200 flex items-center gap-1.5">
                                    <i class="fas fa-chart-bar mr-1"></i>                                    Raporlar                                    <i class="fas fa-chevron-down text-xs"></i>
                                </button>
                                <div id="dropdown-reports" style="display: none; position: fixed; z-index: 99999;" class="mt-2 w-64 rounded-lg shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 py-2" onclick="event.stopPropagation();">
                                                                                                                                                                                                                                                                                                                                <a href="/app/reports"
                                               class="flex items-center gap-2 px-4 py-2 text-sm transition-colors duration-150 text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">
                                                <i class="fas fa-list w-4 text-primary-500 dark:text-primary-300"></i>                                                <span>T├╝m Raporlar</span>
                                            </a>
                                                                                                                                <a href="/app/reports/financial"
                                               class="flex items-center gap-2 px-4 py-2 text-sm transition-colors duration-150 text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">
                                                <i class="fas fa-money-bill-wave w-4 text-primary-500 dark:text-primary-300"></i>                                                <span>Finansal Rapor</span>
                                            </a>
                                                                                                                                <a href="/app/reports/jobs"
                                               class="flex items-center gap-2 px-4 py-2 text-sm transition-colors duration-150 text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">
                                                <i class="fas fa-tasks w-4 text-primary-500 dark:text-primary-300"></i>                                                <span>─░┼ş Raporu</span>
                                            </a>
                                                                                                                                <a href="/app/reports/services"
                                               class="flex items-center gap-2 px-4 py-2 text-sm transition-colors duration-150 text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700">
                                                <i class="fas fa-concierge-bell w-4 text-primary-500 dark:text-primary-300"></i>                                                <span>Hizmet Analizi</span>
                                            </a>
                                                                                                            </div>
                            </div>
                                                            </div>
            </div>
        </div>
    </div>

    <div id="mobile-menu" style="display: none;" class="sm:hidden mobile-nav border-t border-white/20">
        <div class="px-2 pt-2 pb-3 space-y-1">
                                                                                                    <a href="/app/"
                           class="mobile-nav__link ">
                            <i class="fas fa-home"></i>                            <span>Ana</span>
                        </a>
                                                                                                                            <a href="/app/calendar"
                           class="mobile-nav__link ">
                            <i class="fas fa-calendar"></i>                            <span>Takvim</span>
                        </a>
                                                                                                                            <a href="/app/jobs"
                           class="mobile-nav__link mobile-nav__link--active">
                            <i class="fas fa-tasks"></i>                            <span>─░┼şler</span>
                        </a>
                                                                                                                            <a href="/app/customers"
                           class="mobile-nav__link ">
                            <i class="fas fa-users"></i>                            <span>M├╝┼şteriler</span>
                        </a>
                                                                                                                        <details class="mobile-nav__section" id="section-management">
                        <summary class="mobile-nav__section-trigger flex items-center justify-between gap-2 px-3 py-2 rounded-lg bg-white/10 text-white text-sm">
                            <span class="inline-flex items-center gap-2">
                                <i class="fas fa-briefcase"></i>                                Y├Ânetim                            </span>
                            <i class="fas fa-chevron-down text-xs opacity-70"></i>
                        </summary>
                        <div class="mobile-nav__section-body mt-1 space-y-1">
                                                                                                                                                                                                <a href="/app/ointments"
                                       class="mobile-nav__sublink ">
                                        <i class="fas fa-calendar-check"></i>                                        <span>Randevular</span>
                                    </a>
                                                                                                        <a href="/app/staff"
                                       class="mobile-nav__sublink ">
                                        <i class="fas fa-user-tie"></i>                                        <span>Personel</span>
                                    </a>
                                                                                    </div>
                    </details>
                                            <div class="mobile-nav__divider"></div>
                                                                                                                        <details class="mobile-nav__section" id="section-operations">
                        <summary class="mobile-nav__section-trigger flex items-center justify-between gap-2 px-3 py-2 rounded-lg bg-white/10 text-white text-sm">
                            <span class="inline-flex items-center gap-2">
                                <i class="fas fa-cogs"></i>                                Operasyon                            </span>
                            <i class="fas fa-chevron-down text-xs opacity-70"></i>
                        </summary>
                        <div class="mobile-nav__section-body mt-1 space-y-1">
                                                                                                                                                                                                <a href="/app/recurring"
                                       class="mobile-nav__sublink ">
                                        <i class="fas fa-redo"></i>                                        <span>Periyodik</span>
                                    </a>
                                                                                                        <a href="/app/services"
                                       class="mobile-nav__sublink ">
                                        <i class="fas fa-concierge-bell"></i>                                        <span>Hizmetler</span>
                                    </a>
                                                                                    </div>
                    </details>
                                            <div class="mobile-nav__divider"></div>
                                                                                                                        <details class="mobile-nav__section" id="section-reports">
                        <summary class="mobile-nav__section-trigger flex items-center justify-between gap-2 px-3 py-2 rounded-lg bg-white/10 text-white text-sm">
                            <span class="inline-flex items-center gap-2">
                                <i class="fas fa-chart-bar"></i>                                Raporlar                            </span>
                            <i class="fas fa-chevron-down text-xs opacity-70"></i>
                        </summary>
                        <div class="mobile-nav__section-body mt-1 space-y-1">
                                                                                                                                                                                                <a href="/app/reports"
                                       class="mobile-nav__sublink ">
                                        <i class="fas fa-list"></i>                                        <span>T├╝m Raporlar</span>
                                    </a>
                                                                                                        <a href="/app/reports/financial"
                                       class="mobile-nav__sublink ">
                                        <i class="fas fa-money-bill-wave"></i>                                        <span>Finansal Rapor</span>
                                    </a>
                                                                                                        <a href="/app/reports/jobs"
                                       class="mobile-nav__sublink ">
                                        <i class="fas fa-tasks"></i>                                        <span>─░┼ş Raporu</span>
                                    </a>
                                                                                                        <a href="/app/reports/services"
                                       class="mobile-nav__sublink ">
                                        <i class="fas fa-concierge-bell"></i>                                        <span>Hizmet Analizi</span>
                                    </a>
                                                                                    </div>
                    </details>
                                                
                    </div>
    </div>
</nav>











        
    
    <!-- Skip to main content link -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:bg-primary-600 focus:text-white focus:p-2 focus:z-50 focus:rounded-br-md">
        Ana i├ğeri─şe atla
    </a>

    <!-- New UI sidebar -->
    
    <!-- Main Content -->
    <main id="main-content" class="py-4 sm:py-6 bg-gray-50 dark:bg-gray-900 flex-1 " role="main">
        <!-- ARIA live regions for global form status and errors -->
        <div aria-live="polite" aria-atomic="true" class="sr-only" id="aria-status-region"></div>
        <div aria-live="assertive" aria-atomic="true" class="sr-only" id="aria-error-region"></div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Flash Messages -->
                        
            <!-- Page Content -->
            <div class="fade-in">
                <div class="space-y-8">
    <!-- Breadcrumb -->
    <nav class="flex" aria-label="Breadcrumb">
        <ol class="flex items-center space-x-4">
            <li><a href="/app/jobs" class="text-gray-400 hover:text-primary-600"><i class="fas fa-tasks"></i></a></li>
            <li class="flex items-center"><i class="fas fa-chevron-right text-gray-400 mx-2"></i><span class="text-gray-500">Yeni ─░┼ş</span></li>
        </ol>
    </nav>

    <!-- Header -->
    <div>
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white flex items-center">
            <i class="fas fa-tasks mr-3 text-primary-600"></i>
            Yeni ─░┼ş        </h1>
        <p class="text-gray-600 dark:text-gray-400 mt-2">Yeni bir i┼ş kayd─▒ olu┼şturun</p>
    </div>

    
    <!-- Form Container -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-soft border border-gray-200 dark:border-gray-700 overflow-hidden">
        <form method="POST" action="/app/jobs/create" 
              x-data="jobForm()" 
              @submit="handleFormSubmit($event)"
              data-auto-save="30000"
              id="jobForm"
              role="form" aria-describedby="job-form-errors" novalidate data-validate="true">
            <input type="hidden" name="csrf_token" value="3a105ef969e8ed449246b6eb664eaff8c38d4137bea5204bf2391332a1317f3d">
            <!-- SECTION 1: Temel Bilgiler -->
            <div class="border-b border-gray-200 dark:border-gray-700">
                <div class="px-6 py-4 bg-gradient-to-r from-primary-50 to-blue-50 dark:from-primary-900/20 dark:to-blue-900/20">
                    <h2 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center">
                        <i class="fas fa-info-circle mr-2 text-primary-600"></i>
                        Temel Bilgiler
                    </h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">M├╝┼şteri ve hizmet bilgileri</p>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Customer Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-user mr-2 text-primary-600"></i>M├╝┼şteri <span class="text-red-500">*</span>
                            </label>
                            <div class="relative">
                                <input type="text" 
                                       x-model="customerQuery" 
                                       @input="searchCustomers" 
                                       @focus="if(customerQuery.length >= 2) showCustomerList = true"
                                       @blur="onCustomerInputBlur"
                                       @keydown.arrow-down="if(showCustomerList && customerResults.length > 0) { $event.preventDefault(); $refs.customerList.firstElementChild?.focus(); }"
                                       @keydown.escape="showCustomerList = false"
                                       placeholder="M├╝┼şteri ad─▒ yaz─▒n..." 
                                       class="w-full px-4 py-3 border-2 border-primary-300 dark:border-primary-700 rounded-lg bg-white/70 dark:bg-primary-900/10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:text-white transition-all duration-200 shadow-inner" 
                                       autocomplete="off"
                                       role="combobox"
                                       aria-expanded="false"
                                       aria-haspopup="listbox"
                                       aria-autocomplete="list">
                                <i x-show="!isSearchingCustomers" class="fas fa-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                <i x-show="isSearchingCustomers" class="fas fa-spinner fa-spin absolute right-3 top-1/2 -translate-y-1/2 text-primary-500"></i>
                            </div>
                            <input type="hidden" name="customer_id" :value="customerId" required>
                            <div x-show="showCustomerList" 
                                 x-ref="customerList"
                                 x-transition:enter="transition ease-out duration-100"
                                 x-transition:enter-start="opacity-0 scale-95"
                                 x-transition:enter-end="opacity-100 scale-100"
                                 class="absolute z-50 bg-white dark:bg-gray-800 border-2 border-primary-200 dark:border-primary-700 rounded-lg mt-2 w-full max-h-64 overflow-auto shadow-xl"
                                 style="display: none;"
                                 @mousedown="isInteractingWithCustomerList = true"
                                 @mouseup="isInteractingWithCustomerList = false"
                                 role="listbox"
                                 aria-label="M├╝┼şteri listesi">
                                <template x-for="(item, index) in customerResults" :key="item.id">
                                    <div class="px-4 py-3 hover:bg-primary-50 dark:hover:bg-primary-900/20 cursor-pointer border-b border-gray-100 dark:border-gray-700 last:border-0 transition-colors focus:bg-primary-50 dark:focus:bg-primary-900/20 focus:outline-none" 
                                         @click="selectCustomer(item)"
                                         @keydown.enter="selectCustomer(item)"
                                         @keydown.arrow-down="if(index < customerResults.length - 1) $event.target.nextElementSibling?.focus()"
                                         @keydown.arrow-up="if(index > 0) $event.target.previousElementSibling?.focus()"
                                         @keydown.escape="showCustomerList = false"
                                         tabindex="0"
                                         role="option"
                                         :aria-selected="customerId === item.id">
                                        <div class="flex items-center">
                                            <i class="fas fa-user-circle text-primary-500 mr-3"></i>
                                            <span class="font-medium text-gray-900 dark:text-white" x-text="item.name"></span>
                                        </div>
                                    </div>
                                </template>
                                <div x-show="isSearchingCustomers" class="px-4 py-3 text-center text-sm text-gray-500">
                                    <i class="fas fa-spinner fa-spin mr-2"></i>Aran─▒yor...
                                </div>
                                <div x-show="!isSearchingCustomers && customerResults.length === 0" class="px-4 py-3 text-center text-sm text-gray-500">
                                    <i class="fas fa-search mr-2"></i>Sonu├ğ bulunamad─▒
                                </div>
                                <div class="px-4 py-3 border-t border-gray-200 bg-primary-50 dark:bg-primary-900/10">
                                    <button type="button"
                                            id="btn-new-customer"
                                            @mousedown.prevent.stop="openNewCustomerModal"
                                            @click.prevent.stop="openNewCustomerModal"
                                            onclick="return window.__openNewCustomerModal && window.__openNewCustomerModal(event)"
                                            class="w-full text-left text-primary-600 hover:text-primary-700 font-medium pointer-events-auto"
                                            style="z-index:9999">
                                        <i class="fas fa-plus mr-2"></i>Yeni M├╝┼şteri Ekle
                                    </button>
                                    <button type="button"
                                            x-show="nextCursor"
                                            @click="loadMoreCustomers"
                                            class="mt-2 w-full text-left text-gray-600 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white text-sm">
                                        <i class="fas fa-ellipsis-h mr-2"></i>Daha fazla y├╝kle
                                    </button>
                                    <noscript>
                                        <a class="block text-primary-600 hover:text-primary-700 font-medium mt-2" href="/app/customers/new?return=%2Fapp%2Fjobs%2Fnew&prefill[name]=">
                                            <i class="fas fa-external-link-alt mr-2"></i>Yeni M├╝┼şteri Ekle (No-JS)
                                        </a>
                                    </noscript>
                                </div>
                            </div>
                        </div>

                        <!-- Address Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-map-marker-alt mr-2 text-primary-600"></i>Adres
                            </label>
                            <div class="space-y-3">
                                <div class="relative">
                                    <select name="address_id" 
                                            x-model="addressId" 
                                            class="w-full px-4 py-3 border-2 border-primary-300 dark:border-primary-700 rounded-lg bg-white/70 dark:bg-primary-900/10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:text-white transition-all duration-200 appearance-none shadow-inner">
                                        <option value="">Adres se├ğiniz</option>
                                        <template x-for="addr in addresses" :key="addr.id">
                                            <option :value="addr.id" x-text="addr.label ? (addr.label + ' - ' + addr.line) : addr.line"></option>
                                        </template>
                                    </select>
                                    <i class="fas fa-chevron-down absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
                                </div>
                                <button type="button" 
                                        @click="showNewAddressForm = !showNewAddressForm" 
                                        class="w-full inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-primary-600 hover:text-primary-700 border-2 border-dashed border-primary-300 dark:border-primary-700 rounded-lg bg-white/60 dark:bg-primary-900/10 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-colors">
                                    <i class="fas fa-plus mr-2"></i>Yeni Adres Ekle
                                </button>
                            </div>
                            
                            <!-- New Address Form -->
                            <div x-show="showNewAddressForm" 
                                 x-transition
                                 class="mt-4 p-4 border-2 border-dashed border-primary-300 dark:border-primary-700 rounded-lg bg-primary-50/50 dark:bg-primary-900/10">
                                <div class="flex items-center mb-4">
                                    <i class="fas fa-map-marker-alt text-primary-600 mr-2"></i>
                                    <h4 class="text-sm font-semibold text-gray-900 dark:text-white">Yeni Adres</h4>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1">Etiket</label>
                                        <input type="text" x-model="newAddress.label" name="new_address_label" placeholder="Ev, ─░┼ş, vb." 
                                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white transition-all duration-200">
                                    </div>
                                    <div class="md:col-span-2">
                                        <label class="block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1">Adres <span class="text-red-500">*</span></label>
                                        <input type="text" x-model="newAddress.line" name="new_address_line" placeholder="Tam adres bilgisi" 
                                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white transition-all duration-200">
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1">┼Şehir</label>
                                        <input type="text" x-model="newAddress.city" name="new_address_city" placeholder="┼Şehir" 
                                               class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white transition-all duration-200">
                                    </div>
                                </div>
                                <div class="flex justify-end gap-3 mt-4">
                                    <button type="button" @click="cancelNewAddress()" class="px-4 py-2 text-sm font-medium rounded-md bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500 transition-colors">
                                        <i class="fas fa-times mr-1"></i>─░ptal
                                    </button>
                                    <button type="button" @click="saveNewAddress()" :disabled="!newAddress.line.trim()" 
                                            class="px-4 py-2 text-sm font-medium rounded-md bg-primary-600 hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                                            style="color: white !important; background: #4f46e5 !important;">
                                        <i class="fas fa-save mr-1" style="color: white !important;"></i>
                                        <span style="color: white !important;">Kaydet</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Service Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-cogs mr-2 text-primary-600"></i>Hizmet <span class="text-red-500">*</span>
                            </label>
                            <div class="relative">
                                <select name="service_id" 
                                        x-model.number="serviceId" 
                                        @change="applyServiceDefaults()" 
                                        class="w-full px-4 py-3 border-2 border-primary-300 dark:border-primary-700 rounded-lg bg-white/70 dark:bg-primary-900/10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:text-white transition-all duration-200 appearance-none shadow-inner"
                                        required aria-required="true" aria-invalid="false"
                                        aria-describedby="service-error service-hint"
                                        data-validate="required|numeric|min:1">
                                    <option value="">Hizmet se├ğiniz</option>
                                                                            <option value="5" 
                                                data-duration="45" 
                                                data-fee="60" 
                                                >
                                            Balkon Temizli─şi                                        </option>
                                                                            <option value="3" 
                                                data-duration="60" 
                                                data-fee="80" 
                                                >
                                            Cam Temizli─şi                                        </option>
                                                                            <option value="1" 
                                                data-duration="120" 
                                                data-fee="150" 
                                                >
                                            Ev Temizli─şi                                        </option>
                                                                            <option value="4" 
                                                data-duration="180" 
                                                data-fee="200" 
                                                >
                                            Hal─▒ Y─▒kama                                        </option>
                                                                            <option value="6" 
                                                data-duration="150" 
                                                data-fee="180" 
                                                >
                                            Ma─şaza Temizli─şi                                        </option>
                                                                            <option value="2" 
                                                data-duration="90" 
                                                data-fee="100" 
                                                >
                                            Ofis Temizli─şi                                        </option>
                                                                            <option value="8" 
                                                data-duration="60" 
                                                data-fee="120" 
                                                >
                                            Site Y├Ânetimi                                        </option>
                                                                            <option value="7" 
                                                data-duration="240" 
                                                data-fee="300" 
                                                >
                                            ─░n┼şaat Sonras─▒ Temizlik                                        </option>
                                                                    </select>
                                <i class="fas fa-chevron-down absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
                            </div>
                            <p id="service-error" class="field-error hidden text-sm text-red-600 mt-1"></p>
                            <p id="service-hint" class="text-sm text-gray-500 dark:text-gray-400 mt-1">Bir hizmet se├ğiniz</p>
                        </div>

                        <!-- Status Field -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-tasks mr-2 text-primary-600"></i>Durum
                            </label>
                            <div class="relative">
                                <select name="status" class="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white/70 dark:bg-gray-700 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:text-white transition-all duration-200 appearance-none shadow-inner">
                                                                            <option value="SCHEDULED" >
                                            Planland─▒                                        </option>
                                                                            <option value="DONE" >
                                            Tamamland─▒                                        </option>
                                                                            <option value="CANCELLED" >
                                            ─░ptal                                        </option>
                                                                    </select>
                                <i class="fas fa-chevron-down absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECTION 2: Zaman ve Tarih -->
            <div class="border-b border-gray-200 dark:border-gray-700">
                <div class="px-6 py-4 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20">
                    <h2 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center">
                        <i class="fas fa-calendar-alt mr-2 text-purple-600"></i>
                        Zaman ve Tarih
                    </h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">─░┼ş ba┼şlang─▒├ğ ve biti┼ş bilgileri</p>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Start Date/Time -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-play-circle mr-2 text-green-600"></i>Ba┼şlang─▒├ğ <span class="text-red-500">*</span>
                            </label>
                            <div class="relative">
                                <input type="datetime-local" 
                                       name="start_at" 
                                       x-model="startAt" 
                                       required 
                                       @change="autoSetEnd()"
                                       aria-required="true" aria-invalid="false"
                                       aria-describedby="start_at-error start_at-hint"
                                       data-validate="required|datetime"
                                       data-no-shortcuts="true"
                                       placeholder="gg.aa.yyyy --:--"
                                       class="w-full px-4 py-3 pr-10 border-2 border-green-300 dark:border-green-700 rounded-lg bg-white/70 dark:bg-green-900/10 focus:ring-2 focus:ring-green-500 focus:border-green-500 dark:text-white transition-all duration-200 shadow-inner">
                                <i class="fas fa-calendar-alt absolute right-3 top-1/2 -translate-y-1/2 text-green-500"></i>
                            </div>
                            <p id="start_at-error" class="field-error hidden text-sm text-red-600 mt-1"></p>
                            <div class="mt-1 flex items-center gap-2 text-gray-600 dark:text-gray-400">
                                <i class="fas fa-info-circle text-green-600"></i>
                                <p id="start_at-hint" class="text-sm">Ba┼şlang─▒├ğ tarih ve saatini se├ğiniz</p>
                            </div>
                        </div>

                        <!-- End Date/Time -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-stop-circle mr-2 text-red-600"></i>Biti┼ş <span class="text-red-500">*</span>
                            </label>
                            <div class="flex gap-2 items-start">
                                <div class="relative flex-1">
                                    <input type="datetime-local" 
                                           name="end_at" 
                                           x-model="endAt" 
                                           required
                                           aria-required="true" aria-invalid="false"
                                           aria-describedby="end_at-error end_at-hint"
                                           data-validate="required|datetime"
                                           data-no-shortcuts="true"
                                           placeholder="gg.aa.yyyy --:--"
                                           class="w-full px-4 py-3 pr-10 border-2 border-red-300 dark:border-red-700 rounded-lg bg-white/70 dark:bg-red-900/10 focus:ring-2 focus:ring-red-500 focus:border-red-500 dark:text-white transition-all duration-200 shadow-inner">
                                    <i class="fas fa-calendar-alt absolute right-3 top-1/2 -translate-y-1/2 text-red-500"></i>
                                </div>
                                <button type="button" 
                                        @click="quickEnd(60)" 
                                        class="px-3 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white/70 dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"
                                        title="Ba┼şlang─▒├ğtan 1 saat sonra">
                                    <i class="fas fa-clock text-sm text-gray-700 dark:text-gray-300"></i>
                                </button>
                                <button type="button" 
                                        @click="quickEnd(120)" 
                                        class="px-3 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white/70 dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"
                                        title="Ba┼şlang─▒├ğtan 2 saat sonra">
                                    <i class="fas fa-clock text-sm text-gray-700 dark:text-gray-300"></i>
                                </button>
                            </div>
                            <p id="end_at-error" class="field-error hidden text-sm text-red-600 mt-1"></p>
                            <div class="mt-1 flex items-center gap-2 text-gray-600 dark:text-gray-400">
                                <i class="fas fa-info-circle text-red-600"></i>
                                <p id="end_at-hint" class="text-sm">Biti┼ş tarihi ba┼şlang─▒├ğtan sonra olmal─▒d─▒r</p>
                            </div>
                            <p class="text-xs text-primary-600 dark:text-primary-400 mt-2 flex items-center" x-show="serviceDuration">
                                <i class="fas fa-info-circle mr-1"></i>
                                Tahmini s├╝re: <span x-text="serviceDuration" class="font-medium ml-1"></span> dakika
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECTION 3: ├£cret ve ├ûdeme -->
            <div class="border-b border-gray-200 dark:border-gray-700">
                <div class="px-6 py-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20">
                    <h2 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center">
                        <i class="fas fa-money-bill-wave mr-2 text-green-600"></i>
                        ├£cret ve ├ûdeme
                    </h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Mali bilgiler ve ├Âdeme detaylar─▒</p>
                </div>
                <div class="p-6">
                    <!-- Summary Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                        <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-900/40 border-2 border-blue-200 dark:border-blue-800 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-xs font-medium text-blue-700 dark:text-blue-300">Toplam</span>
                                <i class="fas fa-calculator text-blue-600"></i>
                            </div>
                            <div class="relative">
                                <input type="number" 
                                       step="0.01" 
                                       name="total_amount" 
                                       x-model="totalAmount" 
                                       required 
                                       placeholder="0.00"
                                       aria-required="true" aria-invalid="false"
                                       aria-describedby="total_amount-error total_amount-hint"
                                       inputmode="decimal"
                                       data-validate="required|numeric|min:0.01"
                                       class="w-full bg-white/70 dark:bg-blue-900/20 border-2 border-blue-300 dark:border-blue-700 text-2xl font-bold text-blue-900 dark:text-blue-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 rounded-lg pr-10 px-3 shadow-inner transition-colors">
                                <span class="absolute right-2 top-1/2 -translate-y-1/2 text-blue-700 dark:text-blue-300 select-none">Ôé║</span>
                            </div>
                            <p id="total_amount-error" class="field-error hidden text-sm text-red-600 mt-2"></p>
                            <p id="total_amount-hint" class="text-sm text-blue-700 dark:text-blue-300 mt-1 break-words">Pozitif bir tutar giriniz</p>
                        </div>

                        <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-900/40 border-2 border-green-200 dark:border-green-800 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-xs font-medium text-green-700 dark:text-green-300">├ûdenen</span>
                                <i class="fas fa-check-circle text-green-600"></i>
                            </div>
                            <p class="text-2xl font-bold text-green-900 dark:text-green-100" x-text="formatMoney(alreadyPaid)"></p>
                        </div>

                        <div class="bg-gradient-to-br rounded-lg p-4 border-2" 
                             :class="remainingAmount() > 0 ? 'from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 border-orange-200 dark:border-orange-800' : 'from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/40 border-green-200 dark:border-green-800'">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-xs font-medium" :class="remainingAmount() > 0 ? 'text-orange-700 dark:text-orange-300' : 'text-green-700 dark:text-green-300'">Kalan</span>
                                <i class="fas fa-hourglass-half" :class="remainingAmount() > 0 ? 'text-orange-600' : 'text-green-600'"></i>
                            </div>
                            <p class="text-2xl font-bold" 
                               :class="remainingAmount() > 0 ? 'text-orange-900 dark:text-orange-100' : 'text-green-900 dark:text-green-100'"
                               x-text="formatMoney(remainingAmount())"></p>
                        </div>
                    </div>

                    <!-- Payment Details -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-plus-circle mr-2 text-primary-600"></i>Yeni ├ûdeme
                            </label>
                            <div class="relative">
                                <input type="number" 
                                       step="0.01" 
                                       name="payment_amount" 
                                       x-model="paymentAmount" 
                                       placeholder="0.00"
                                       aria-describedby="payment_amount-error payment_amount-hint"
                                       inputmode="decimal"
                                       data-validate="numeric|min:0"
                                       class="w-full pr-10 px-4 py-3 border-2 border-primary-300 dark:border-primary-700 rounded-lg bg-white/70 dark:bg-primary-900/10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:text-white transition-all duration-200 shadow-inner">
                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-primary-600">Ôé║</span>
                                <p id="payment_amount-error" class="field-error hidden text-sm text-red-600 mt-1"></p>
                                <p id="payment_amount-hint" class="text-sm text-gray-500 dark:text-gray-400 mt-1">Varsa yeni ├Âdeme tutar─▒n─▒ giriniz</p>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-calendar mr-2 text-primary-600"></i>├ûdeme Tarihi
                            </label>
                            <input type="date" 
                                   name="payment_date" 
                                   x-model="paymentDate"
                                   aria-describedby="payment_date-error payment_date-hint"
                                   data-validate="date"
                                   class="w-full px-4 py-3 border-2 border-primary-300 dark:border-primary-700 rounded-lg bg-white/70 dark:bg-primary-900/10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:text-white transition-all duration-200 shadow-inner">
                            <p id="payment_date-error" class="field-error hidden text-sm text-red-600 mt-1"></p>
                            <p id="payment_date-hint" class="text-sm text-gray-500 dark:text-gray-400 mt-1">├ûdeme tarihini iste─şe ba─şl─▒ giriniz</p>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-comment mr-2 text-primary-600"></i>├ûdeme Notu
                            </label>
                            <input type="text" 
                                   name="payment_note" 
                                   x-model="paymentNote" 
                                   placeholder="Not (opsiyonel)"
                                   class="w-full px-4 py-3 border-2 border-primary-300 dark:border-primary-700 rounded-lg bg-white/70 dark:bg-primary-900/10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:text-white transition-all duration-200 shadow-inner">
                        </div>
                    </div>

                    <!-- Summary Info -->
                    <div class="mt-6 bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-200 dark:border-blue-800 rounded-lg px-4 py-3 flex items-center justify-between">
                        <span class="font-medium text-blue-900 dark:text-blue-100">
                            <i class="fas fa-calculator mr-2"></i>Yeni ├Âdeme sonras─▒ kalan:
                        </span>
                        <span class="text-2xl font-bold text-blue-900 dark:text-blue-100" x-text="formatMoney(remainingAfterNew())"></span>
                    </div>
                </div>
            </div>

            <!-- SECTION 4: Not -->
            <div class="border-b border-gray-200 dark:border-gray-700">
                <div class="px-6 py-4 bg-gradient-to-r from-gray-50 to-slate-50 dark:from-gray-700 dark:to-slate-800">
                    <h2 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center">
                        <i class="fas fa-sticky-note mr-2 text-gray-600"></i>
                        Ek Bilgiler
                    </h2>
                </div>
                <div class="p-6">
                    <textarea name="note" 
                              rows="4" 
                              placeholder="─░┼ş hakk─▒nda notlar, ├Âzel talimatlar vb..."
                              class="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 dark:bg-gray-700 dark:text-white transition-all duration-200 resize-none"></textarea>
                </div>
            </div>

            <!-- Footer Actions -->
            <div class="px-6 py-4 bg-gray-50 dark:bg-gray-700/50 flex justify-between items-center border-t border-gray-200 dark:border-gray-700">
                <div class="flex gap-2">
                    <button type="button" 
                            @click="loadDraft()" 
                            class="px-4 py-2 text-sm rounded-lg bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/40 transition-colors">
                        <i class="fas fa-upload mr-1"></i>Tasla─ş─▒ Y├╝kle
                    </button>
                    <button type="button" 
                            @click="clearDraft()" 
                            class="px-4 py-2 text-sm rounded-lg bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/40 transition-colors">
                        <i class="fas fa-trash mr-1"></i>Tasla─ş─▒ Sil
                    </button>
                </div>
                <div class="flex gap-4">
                    <a href="/app/jobs" 
                       class="px-6 py-3 rounded-lg bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500 font-medium transition-all duration-200">
                        <i class="fas fa-times mr-2"></i>─░ptal
                    </a>
                    <button type="submit" 
                            class="px-8 py-3 rounded-lg bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                            style="color: white !important; background: linear-gradient(to right, #4f46e5, #4338ca) !important;"
                            :disabled="isSubmitting"
                            :class="{'opacity-50 cursor-not-allowed': isSubmitting}">
                        <i class="fas fa-save mr-2" style="color: white !important;"></i><span style="color: white !important;">Kaydet</span>
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- New Customer Modal -->
<div x-show="showNewCustomerModal" 
     id="newCustomerModal"
     x-transition
     class="fixed inset-0 z-50 overflow-y-auto" 
     role="dialog" aria-modal="true" aria-labelledby="newCustomerTitle"
     style="display: none;">
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" @click="cancelNewCustomer()"></div>
        
        <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
            <div class="px-6 py-4 bg-gradient-to-r from-primary-600 to-primary-700">
                <h3 id="newCustomerTitle" class="text-lg font-semibold text-white flex items-center">
                    <i class="fas fa-user-plus mr-2"></i>
                    Yeni M├╝┼şteri Ekle
                </h3>
            </div>
            
            <div class="bg-white dark:bg-gray-800 px-6 py-4">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                            <i class="fas fa-user mr-2 text-primary-600"></i>M├╝┼şteri Ad─▒ <span class="text-red-500">*</span>
                        </label>
                        <input type="text" 
                               x-model="newCustomer.name" 
                               name="new_customer_name"
                               placeholder="M├╝┼şteri ad─▒n─▒ girin" 
                               class="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white transition-all duration-200"
                               autofocus>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                            <i class="fas fa-phone mr-2 text-primary-600"></i>Telefon Numaras─▒
                        </label>
                        <input type="tel" 
                               x-model="newCustomer.phone" 
                               name="new_customer_phone"
                               placeholder="Telefon numaras─▒ (opsiyonel)" 
                               class="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white transition-all duration-200">
                    </div>
                </div>
            </div>
            
            <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4 flex justify-end gap-3">
                <button type="button" 
                        @click="cancelNewCustomer()" 
                        onclick="return window.__cancelNewCustomerFallback && window.__cancelNewCustomerFallback(event)"
                        class="px-4 py-2 rounded-lg border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <i class="fas fa-times mr-2"></i>─░ptal
                </button>
                <button type="button" 
                        id="btn-save-new-customer"
                        @click="saveNewCustomer()" 
                        onclick="return window.__saveNewCustomerFallback && window.__saveNewCustomerFallback(event)"
                        class="px-4 py-2 rounded-lg bg-primary-600 hover:bg-primary-700 transition-colors font-medium"
                        style="color: white !important; background: #4f46e5 !important;">
                    <i class="fas fa-save mr-2" style="color: white !important;"></i>
                    <span style="color: white !important;">Kaydet</span>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// Absolute fallback opener in case Alpine handlers are not bound for any reason
window.__openNewCustomerModal = function(ev){
    try { ev && ev.preventDefault(); ev && ev.stopPropagation(); } catch(_){}
    try {
        const root = document.querySelector('form[x-data]');
        if (root && root.__x && root.__x.$data) {
            root.__x.$data.showNewCustomerModal = true;
            return false;
        }
    } catch(_){}
    // Fallback: force-display modal container if Alpine not active
    var modal = document.querySelector('div#newCustomerModal, [x-show=\"showNewCustomerModal\"]');
    if (modal) { modal.style.display = 'block'; }
    return false;
};

// Basic focus trap for modal
document.addEventListener('keydown', function(e){
    try {
        const modal = document.getElementById('newCustomerModal');
        if (!modal || modal.style.display === 'none') return;
        if (e.key === 'Escape') {
            window.__cancelNewCustomerFallback(e);
            return;
        }
        if (e.key !== 'Tab') return;
        const focusables = modal.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');
        if (!focusables.length) return;
        const first = focusables[0];
        const last = focusables[focusables.length - 1];
        if (e.shiftKey && document.activeElement === first) { last.focus(); e.preventDefault(); }
        else if (!e.shiftKey && document.activeElement === last) { first.focus(); e.preventDefault(); }
    } catch(_){}
});

// Absolute fallback saver (ensures click always handled)
window.__saveNewCustomerFallback = async function(ev){
    try { ev && ev.preventDefault(); ev && ev.stopPropagation(); } catch(_){}
    // If Alpine is active and method exists, let Alpine handle
    try {
        const root = document.querySelector('form[x-data]');
        if (root && root.__x && root.__x.$data && typeof root.__x.$data.saveNewCustomer === 'function') {
            return false;
        }
    } catch(_){}
    // Fallback path
    const nameEl = document.querySelector('input[name="new_customer_name"]');
    const phoneEl = document.querySelector('input[name="new_customer_phone"]');
    const name = (nameEl && nameEl.value || '').trim();
    const phone = (phoneEl && phoneEl.value || '').trim();
    if (!name) { alert('M├╝┼şteri ad─▒ zorunludur.'); return false; }
    try {
        const res = await fetch('/app/api/customers', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRF-Token': '3a105ef969e8ed449246b6eb664eaff8c38d4137bea5204bf2391332a1317f3d'
            },
            body: JSON.stringify({ name: name, phone: phone })
        });
        const data = await res.json().catch(() => ({}));
        if (data && data.success && data.data && data.data.id) {
            const hiddenId = document.querySelector('input[name="customer_id"]');
            const visibleInput = document.querySelector('input[placeholder="M├╝┼şteri ad─▒ yaz─▒n..."]');
            if (hiddenId) hiddenId.value = data.data.id;
            if (visibleInput) visibleInput.value = name;
            const modal = document.getElementById('newCustomerModal');
            if (modal) modal.style.display = 'none';
            return false;
        }
        alert((data && data.error) ? data.error : 'M├╝┼şteri olu┼şturulamad─▒');
    } catch(e) {
        alert('Bir hata olu┼ştu: ' + e.message);
    }
    return false;
};

// Absolute fallback cancel for modal
window.__cancelNewCustomerFallback = function(ev){
    try { ev && ev.preventDefault(); ev && ev.stopPropagation(); } catch(_){}
    try {
        const root = document.querySelector('form[x-data]');
        if (root && root.__x && root.__x.$data && typeof root.__x.$data.cancelNewCustomer === 'function') {
            // Alpine will handle it
            return false;
        }
    } catch(_){}
    const modal = document.getElementById('newCustomerModal');
    if (modal) { modal.style.display = 'none'; }
    return false;
};

// Absolute fallback saver if Alpine is not active
(function(){
    const btn = document.getElementById('btn-save-new-customer');
    if (!btn) return;
    btn.addEventListener('click', async function(ev){
        // If Alpine is active, let Alpine handle it
        try {
            const root = document.querySelector('form[x-data]');
            if (root && root.__x && root.__x.$data && typeof root.__x.$data.saveNewCustomer === 'function') {
                return;
            }
        } catch(_) {}
        ev.preventDefault();
        ev.stopPropagation();
        // Fallback: read fields and call API directly
        const nameEl = document.querySelector('input[name="new_customer_name"]');
        const phoneEl = document.querySelector('input[name="new_customer_phone"]');
        const name = (nameEl && nameEl.value || '').trim();
        const phone = (phoneEl && phoneEl.value || '').trim();
        if (!name) { alert('M├╝┼şteri ad─▒ zorunludur.'); return; }
        try {
            const res = await fetch('/app/api/customers', {
                method: 'POST',
                headers: { 
                    'Content-Type': 'application/json',
                    'X-CSRF-Token': '3a105ef969e8ed449246b6eb664eaff8c38d4137bea5204bf2391332a1317f3d'
                },
                body: JSON.stringify({ name: name, phone: phone })
            });
            const data = await res.json().catch(() => ({}));
            if (data && data.success && data.data && data.data.id) {
                // Fill form fields
                const hiddenId = document.querySelector('input[name="customer_id"]');
                const visibleInput = document.querySelector('input[placeholder="M├╝┼şteri ad─▒ yaz─▒n..."]');
                if (hiddenId) hiddenId.value = data.data.id;
                if (visibleInput) visibleInput.value = name;
                // Hide modal
                const modal = document.getElementById('newCustomerModal');
                if (modal) modal.style.display = 'none';
            } else {
                alert((data && data.error) ? data.error : 'M├╝┼şteri olu┼şturulamad─▒');
            }
        } catch(e) {
            alert('Bir hata olu┼ştu: ' + e.message);
        }
    });
})();

function jobForm() {
    return {
        isSubmitting: false,
        isInteractingWithCustomerList: false,
        
        // Customer selection
        customerId: null,
        customerQuery: '',
        customerResults: [],
        showCustomerList: false,
        isSearchingCustomers: false,
        nextCursor: null, // ROUND 13: Fix Alpine nextCursor error (pagination cursor for customer search)
        
        // Address management
        addressId: null,
        addresses: [],
        showNewAddressForm: false,
        newAddress: { label: '', line: '', city: '' },
        
        // Customer modal
        showNewCustomerModal: false,
        newCustomer: { name: '', phone: '' },
        
        // Service and timing
        serviceId: null,
        serviceDuration: 0,
        startAt: '',
        endAt: '',
        
        // Payment
        totalAmount: '',
        totalAmountTouched: false,
        alreadyPaid: 0,
        paymentAmount: '',
        paymentDate: '2025-11-25',
        paymentNote: '',
        
        // Customer search with debounce
        searchTimeout: null,
        
        // Auto-save functionality
        autoSaveTimeout: null,
        lastSavedData: null,
        
        async searchCustomers() {
            // Clear previous timeout
            if (this.searchTimeout) {
                clearTimeout(this.searchTimeout);
            }
            
            const q = this.customerQuery ? this.customerQuery.trim() : '';
            if (q.length < 2) { 
                this.customerResults = []; 
                this.showCustomerList = false; 
                this.nextCursor = null; // ROUND 13: Reset cursor on new search
                return; 
            }
            
            // Debounce search requests
            this.searchTimeout = setTimeout(async () => {
                this.isSearchingCustomers = true;
                try {
                    const res = await fetch('/app/api/search-customers?q=' + encodeURIComponent(q) + '&limit=20');
                    const data = await res.json();
                    if (data.success) {
                        this.customerResults = (data.data || []).slice(0, 20);
                        this.nextCursor = data.nextCursor || null; // ROUND 13: Set cursor from API response
                        this.showCustomerList = true;
                    } else {
                        console.error('Customer search failed:', data.error);
                        this.customerResults = [];
                        this.showCustomerList = false;
                        this.nextCursor = null; // ROUND 13: Reset cursor on error
                    }
                } catch (e) {
                    console.error('Customer search error:', e);
                    this.customerResults = [];
                    this.showCustomerList = false;
                    this.nextCursor = null; // ROUND 13: Reset cursor on error
                } finally {
                    this.isSearchingCustomers = false;
                }
            }, 300); // 300ms debounce
        },
        
        async loadMoreCustomers() {
            if (!this.nextCursor) return; // ROUND 13: Graceful check for nextCursor
            try {
                this.isSearchingCustomers = true;
                const res = await fetch('/app/api/search-customers?q=' + encodeURIComponent(this.customerQuery.trim()) + '&limit=20&cursor=' + encodeURIComponent(this.nextCursor));
                const data = await res.json();
                if (data.success) {
                    const more = data.data || [];
                    this.customerResults = this.customerResults.concat(more).slice(0, 100);
                    this.nextCursor = data.nextCursor || null; // ROUND 13: Update cursor
                } else {
                    this.nextCursor = null; // ROUND 13: Reset cursor if no more results
                }
            } catch(e) {
                console.error('Customer load more error:', e);
                this.nextCursor = null; // ROUND 13: Reset cursor on error
            } finally {
                this.isSearchingCustomers = false;
            }
        },
        
        selectCustomer(item) {
            this.customerId = item.id; 
            this.customerQuery = item.name; 
            this.showCustomerList = false; 
            this.loadAddresses();
        },
        
        onCustomerInputBlur() {
            const self = this;
            setTimeout(function(){
                if (!self.isInteractingWithCustomerList) {
                    self.showCustomerList = false;
                }
            }, 150);
        },
        
        async loadAddresses() {
            if (!this.customerId) { 
                this.addresses = []; 
                this.addressId = null; 
                return; 
            }
            try {
                const res = await fetch('/app/api/customer-addresses/' + this.customerId);
                const data = await res.json();
                if (data.success) {
                    this.addresses = data.data || [];
                }
            } catch (e) {
                console.error('Error loading addresses:', e);
            }
        },
        
        async saveNewAddress() {
            // Validate required fields
            if (!this.newAddress.line.trim()) {
                this.showNotification('Adres bilgisi zorunludur', 'error');
                return;
            }
            if (!this.customerId) {
                this.showNotification('├ûnce bir m├╝┼şteri se├ğmelisiniz', 'error');
                return;
            }
            
            try {
                const res = await fetch(`/app/api/customers/${this.customerId}/addresses`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRF-Token': '3a105ef969e8ed449246b6eb664eaff8c38d4137bea5204bf2391332a1317f3d'
                    },
                    body: JSON.stringify(this.newAddress)
                });
                const data = await res.json();
                if (data.success) {
                    const newAddr = {
                        id: data.data.address_id,
                        label: this.newAddress.label,
                        line: this.newAddress.line,
                        city: this.newAddress.city
                    };
                    this.addresses.push(newAddr);
                    this.addressId = newAddr.id;
                    this.cancelNewAddress();
                    // Show success message
                    this.showNotification('Adres ba┼şar─▒yla eklendi!', 'success');
                } else {
                    this.showNotification(data.error || 'Adres eklenemedi', 'error');
                }
            } catch (e) {
                console.error('Address save error:', e);
                this.showNotification('Bir hata olu┼ştu: ' + e.message, 'error');
            }
        },
        
        cancelNewAddress() {
            this.showNewAddressForm = false;
            this.newAddress = { label: '', line: '', city: '' };
        },
        
        openNewCustomerModal() {
            this.showNewCustomerModal = true;
            this.newCustomer = { name: '', phone: '' };
        },
        
        async saveNewCustomer() {
            // Validate required fields
            if (!this.newCustomer.name.trim()) {
                this.showNotification('M├╝┼şteri ad─▒ zorunludur.', 'error');
                return;
            }
            
            try {
                const res = await fetch('/app/api/customers', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'X-CSRF-Token': '3a105ef969e8ed449246b6eb664eaff8c38d4137bea5204bf2391332a1317f3d'
                    },
                    body: JSON.stringify(this.newCustomer)
                });
                const data = await res.json();
                if (data.success) {
                    try { console.info('customer:create:success', { id: data.data?.id }); } catch(_){}
                    this.customerId = data.data.id;
                    this.customerQuery = this.newCustomer.name;
                    this.showCustomerList = false;
                    this.showNewCustomerModal = false;
                    this.loadAddresses();
                    this.showNotification('M├╝┼şteri ba┼şar─▒yla olu┼şturuldu!', 'success');
                } else {
                    try { console.error('customer:create:fail', data); } catch(_){}
                    this.showNotification(data.error || 'M├╝┼şteri olu┼şturulamad─▒', 'error');
                }
            } catch (e) {
                console.error('Customer creation error:', e);
                this.showNotification('Bir hata olu┼ştu: ' + e.message, 'error');
            }
        },
        
        cancelNewCustomer() {
            this.showNewCustomerModal = false;
            this.newCustomer = { name: '', phone: '' };
        },
        
        applyServiceDefaults() {
            const sel = document.querySelector('select[name="service_id"]');
            const opt = sel ? sel.options[sel.selectedIndex] : null;
            if (!opt) return;
            const dur = parseInt(opt.getAttribute('data-duration') || '0', 10);
            const fee = parseFloat(opt.getAttribute('data-fee') || '0');
            this.serviceDuration = dur || 0;
            if (!this.totalAmountTouched && fee) {
                this.totalAmount = fee.toFixed(2);
            }
            if (this.startAt && dur) this.endAt = this.addMinutes(this.startAt, dur);
        },
        
        autoSetEnd() {
            if (this.startAt && this.serviceDuration) this.endAt = this.addMinutes(this.startAt, this.serviceDuration);
        },
        
        quickStart(mins) {
            const now = new Date();
            now.setMinutes(now.getMinutes() + mins);
            this.startAt = this.toInputValue(now);
            this.autoSetEnd();
        },
        
        quickEnd(mins) {
            if (!this.startAt) {
                this.showNotification('├ûnce ba┼şlang─▒├ğ tarihini se├ğiniz', 'error');
                return;
            }
            this.endAt = this.addMinutes(this.startAt, mins);
        },
        
        addMinutes(dtLocal, mins) {
            const d = new Date(dtLocal);
            d.setMinutes(d.getMinutes() + mins);
            return this.toInputValue(d);
        },
        
        toInputValue(d) {
            const pad = (n) => String(n).padStart(2, '0');
            const y = d.getFullYear();
            const m = pad(d.getMonth()+1);
            const day = pad(d.getDate());
            const h = pad(d.getHours());
            const mi = pad(d.getMinutes());
            return `${y}-${m}-${day}T${h}:${mi}`;
        },
        
        parseNumber(value) {
            const num = parseFloat((value || '').toString().replace(',', '.'));
            return isNaN(num) ? 0 : num;
        },
        
        remainingAmount() {
            const total = this.parseNumber(this.totalAmount);
            const paid = this.parseNumber(this.alreadyPaid);
            return Math.max(total - paid, 0);
        },
        
        remainingAfterNew() {
            const total = this.parseNumber(this.totalAmount);
            const paid = this.parseNumber(this.alreadyPaid);
            const upcoming = this.parseNumber(this.paymentAmount);
            return Math.max(total - (paid + upcoming), 0);
        },
        
        formatMoney(value) {
            return this.parseNumber(value).toLocaleString('tr-TR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        },
        
        // Notification system
        showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 ${
                type === 'success' ? 'bg-green-500 text-white' : 
                type === 'error' ? 'bg-red-500 text-white' : 
                'bg-blue-500 text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        },
        
        // Auto-save form data
        autoSave() {
            if (this.autoSaveTimeout) {
                clearTimeout(this.autoSaveTimeout);
            }
            
            this.autoSaveTimeout = setTimeout(() => {
                const formData = {
                    customerId: this.customerId,
                    serviceId: this.serviceId,
                    startAt: this.startAt,
                    endAt: this.endAt,
                    totalAmount: this.totalAmount,
                    note: document.querySelector('textarea[name="note"]')?.value || ''
                };
                
                // Only save if data has changed and has meaningful content
                if (JSON.stringify(formData) !== JSON.stringify(this.lastSavedData)) {
                    // Only save if at least customer or service is selected
                    if (formData.customerId || formData.serviceId || formData.startAt || formData.endAt || formData.totalAmount) {
                        const previousCustomerId = this.lastSavedData?.customerId;
                        localStorage.setItem('jobFormDraft', JSON.stringify(formData));
                        this.lastSavedData = formData;
                        // Only show notification for very significant changes (customer selection)
                        if (formData.customerId && !previousCustomerId) {
                            this.showNotification('M├╝┼şteri se├ğildi - form kaydedildi', 'info');
                        }
                    }
                }
            }, 5000); // Auto-save after 5 seconds of inactivity
        },
        
        // Load draft data
        loadDraft() {
            const draft = localStorage.getItem('jobFormDraft');
            if (draft && !false) {
                try {
                    const data = JSON.parse(draft);
                    if (data.customerId) this.customerId = data.customerId;
                    if (data.serviceId) this.serviceId = data.serviceId;
                    if (data.startAt) this.startAt = data.startAt;
                    if (data.endAt) this.endAt = data.endAt;
                    if (data.totalAmount) this.totalAmount = data.totalAmount;
                    if (data.note) document.querySelector('textarea[name="note"]').value = data.note;
                    
                    this.lastSavedData = data;
                    this.showNotification('Kaydedilen taslak y├╝klendi', 'info');
                } catch (e) {
                    console.error('Error loading draft:', e);
                }
            }
        },
        
        // Clear draft data
        clearDraft() {
            localStorage.removeItem('jobFormDraft');
            this.lastSavedData = null;
        },
        
        // Handle form submission
        handleFormSubmit(event) {
            if (this.isSubmitting) {
                event.preventDefault();
                return false;
            }
            
            // Validate form
            if (!validateForm(event.target)) {
                event.preventDefault();
                return false;
            }
            
            // Set submitting state
            this.isSubmitting = true;
            
            // Clear draft on successful submission
            this.clearDraft();
            
            // Show loading notification
            this.showNotification('Form g├Ânderiliyor...', 'info');
            
            // Allow form to submit normally
            return true;
        },
        
        init() {
            if (this.customerId) this.loadAddresses();
            if (this.serviceId) this.applyServiceDefaults();
            
            // Load draft data
            this.loadDraft();
            
            // Set up auto-save listeners only for important fields
            const importantFields = [
                'input[name="customer_id"]',
                'select[name="service_id"]',
                'input[name="start_at"]',
                'input[name="end_at"]',
                'input[name="total_amount"]',
                'textarea[name="note"]'
            ];
            
            importantFields.forEach(selector => {
                const element = document.querySelector(selector);
                if (element) {
                    element.addEventListener('change', () => this.autoSave());
                    element.addEventListener('blur', () => this.autoSave());
                }
            });
        }
    }
}

// Enhanced form validation
function validateForm(form) {
    const customerId = form.querySelector('input[name="customer_id"]').value;
    const startAt = form.querySelector('input[name="start_at"]').value;
    const endAt = form.querySelector('input[name="end_at"]').value;
    const totalAmount = form.querySelector('input[name="total_amount"]').value;
    const serviceId = form.querySelector('select[name="service_id"]').value;
    
    // Skip validation for modal inputs that are not part of main form
    const modalInputs = form.querySelectorAll('input[name^="new_"]');
    modalInputs.forEach(input => {
        input.removeAttribute('required');
    });
    
    
    // Clear previous error states
    form.querySelectorAll('.form-error').forEach(el => el.classList.remove('form-error'));
    
    let isValid = true;
    let errorMessage = '';
    
    if (!customerId) {
        errorMessage = 'L├╝tfen bir m├╝┼şteri se├ğin.';
        const customerField = form.querySelector('input[name="customer_id"]').closest('div');
        if (customerField) customerField.classList.add('form-error');
        isValid = false;
    }
    
    if (!serviceId) {
        errorMessage = 'L├╝tfen bir hizmet se├ğin.';
        form.querySelector('select[name="service_id"]').classList.add('form-error');
        isValid = false;
    }
    
    if (!startAt) {
        errorMessage = 'L├╝tfen ba┼şlang─▒├ğ tarihini girin.';
        form.querySelector('input[name="start_at"]').classList.add('form-error');
        isValid = false;
    }
    
    if (!endAt) {
        errorMessage = 'L├╝tfen biti┼ş tarihini girin.';
        form.querySelector('input[name="end_at"]').classList.add('form-error');
        isValid = false;
    }
    
    if (!totalAmount || parseFloat(totalAmount) <= 0) {
        errorMessage = 'L├╝tfen ge├ğerli bir toplam tutar girin.';
        form.querySelector('input[name="total_amount"]').classList.add('form-error');
        isValid = false;
    }
    
    if (startAt && endAt) {
        const startDate = new Date(startAt);
        const endDate = new Date(endAt);
        
        if (endDate <= startDate) {
            errorMessage = 'Biti┼ş tarihi ba┼şlang─▒├ğ tarihinden sonra olmal─▒d─▒r.';
            form.querySelector('input[name="end_at"]').classList.add('form-error');
            isValid = false;
        }
    }
    
    if (!isValid) {
        showFormNotification(errorMessage, 'error');
        // Scroll to first error
        const firstError = form.querySelector('.form-error');
        if (firstError) {
            firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    } else {
        // Clear draft on successful validation
        localStorage.removeItem('jobFormDraft');
    }
    
    return isValid;
}

// Form notification system
function showFormNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 ${
        type === 'success' ? 'bg-green-500 text-white' : 
        type === 'error' ? 'bg-red-500 text-white' : 
        'bg-blue-500 text-white'
    }`;
    notification.innerHTML = `
        <div class="flex items-center">
            <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'} mr-2"></i>
            <span>${message}</span>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => notification.remove(), 300);
    }, 5000);
}
</script>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
            <footer class="bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800 w-full footer-container">
    <div class="footer-inner px-3 sm:px-4 lg:px-8 py-8 sm:py-10 w-full">
        <section class="footer-hero grid gap-6 lg:grid-cols-[minmax(0,2fr)_minmax(0,1fr)] mb-10">
            <div class="rounded-2xl bg-gradient-to-br from-primary-50 via-white to-white dark:from-slate-900 dark:via-slate-900 dark:to-slate-950 border border-primary-100/60 dark:border-slate-800 p-6 lg:p-7 shadow-lg shadow-primary-900/5">
                <div class="flex items-center gap-4">
                    <span class="inline-flex items-center justify-center w-12 h-12 rounded-2xl bg-primary-600 text-white shadow-lg shadow-primary-900/25">
                        <i class="fas fa-broom text-xl" aria-hidden="true"></i>
                    </span>
                    <div>
                        <p class="text-sm uppercase tracking-wide text-primary-700 dark:text-primary-200 font-semibold">
                            K├╝re Temizlik Platformu                        </p>
                        <h3 class="text-2xl font-semibold text-slate-900 dark:text-white">
                            Operasyonlar─▒n─▒z─▒ tek panelden y├Ânetin                        </h3>
                                                    <p class="text-xs text-slate-500 dark:text-slate-400">
                                Saha planlama, i┼ş y├Ânetimi ve m├╝┼şteri ileti┼şimini y├╝r├╝t├╝r.                            </p>
                                            </div>
                </div>
                <p class="mt-4 text-sm text-slate-600 dark:text-slate-300 leading-relaxed">
                    Randevular, saha ekipleri, finans ve raporlamay─▒ tek ├ğal─▒┼şma alan─▒nda toplayan modern i┼ş takip sistemi. Ger├ğek zamanl─▒ metrikler ve otomasyonlarla performans─▒n─▒z her an g├Âr├╝n├╝r.                </p>
                <div class="flex flex-wrap gap-3 mt-5">
                    <span class="footer-status-chip text-xs font-semibold">
                        Rol: Operasyon Uzman─▒                    </span>
                                            <span class="footer-status-chip text-xs font-semibold">
                            Filtre: T├╝m├╝                        </span>
                                        <span class="footer-status-chip text-xs font-semibold">
                        Ortam: production                    </span>
                    <span class="footer-status-chip text-xs font-semibold">
                        S├╝r├╝m:                     </span>
                </div>
            </div>
            <div class="rounded-2xl bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 p-6 flex flex-col justify-between shadow-lg shadow-slate-900/10 footer-cta-card">
                <div>
                    <p class="text-xs uppercase tracking-wide text-primary-600 dark:text-primary-300 font-semibold">
                        H─▒zl─▒ aksiyon                    </p>
                    <h4 class="text-xl font-semibold text-slate-900 dark:text-white mt-2">
                        Yeni g├Ârevleri dakikalar i├ğinde planlay─▒n                    </h4>
                    <p class="text-sm text-slate-600 dark:text-slate-300 mt-3">
                        Yo─şun d├Ânemlerde bile ekipleri ayn─▒ sayfada tutun. Merkezi takvim, i┼ş talimat─▒ ve onay ak─▒┼şlar─▒n─▒ tek t─▒klamayla ba┼şlat─▒n.                    </p>
                </div>
                <div class="mt-5 flex flex-col sm:flex-row gap-3">
                                            <a href="/app/jobs/new" class="inline-flex items-center justify-center rounded-xl bg-primary-600 hover:bg-primary-700 text-white text-sm font-semibold px-5 py-3 transition-colors">
                            <i class="fas fa-plus mr-2 text-xs" aria-hidden="true"></i>
                            Yeni ─░┼ş Olu┼ştur                        </a>
                                        <a href="mailto:destek@kuretemizlik.com" class="inline-flex items-center justify-center rounded-xl border border-primary-200 text-primary-700 dark:text-primary-200 hover:border-primary-400 text-sm font-semibold px-5 py-3 transition-colors">
                        <i class="fas fa-headset mr-2 text-xs" aria-hidden="true"></i>
                        Destek Talebi                    </a>
                </div>
                <p class="mt-4 text-xs text-slate-500 dark:text-slate-400">
                    Talep formunuz SLA kapsam─▒na g├Âre ilgili ekip liderine otomatik olarak y├Ânlendirilir.
                </p>
            </div>
        </section>

        <div class="footer-grid grid gap-8 sm:grid-cols-2 lg:grid-cols-4">
            <div>
                <p class="text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400 font-semibold mb-4">
                    Operasyon Mod├╝lleri                </p>
                                    <ul class="space-y-2 text-sm text-slate-600 dark:text-slate-300">
                                                                                <li>
                                <a href="/app/" class="flex items-center gap-2 hover:text-primary-600 transition-colors">
                                    <i class="fas fa-chart-pie text-xs" aria-hidden="true"></i>
                                    Ana Dashboard                                </a>
                            </li>
                                                                                <li>
                                <a href="/app/calendar" class="flex items-center gap-2 hover:text-primary-600 transition-colors">
                                    <i class="fas fa-calendar-alt text-xs" aria-hidden="true"></i>
                                    Takvim                                </a>
                            </li>
                                                                                <li>
                                <a href="/app/jobs" class="flex items-center gap-2 hover:text-primary-600 transition-colors">
                                    <i class="fas fa-list-check text-xs" aria-hidden="true"></i>
                                    ─░┼şler                                </a>
                            </li>
                                                                                <li>
                                <a href="/app/customers" class="flex items-center gap-2 hover:text-primary-600 transition-colors">
                                    <i class="fas fa-users text-xs" aria-hidden="true"></i>
                                    M├╝┼şteriler                                </a>
                            </li>
                                                                                <li>
                                <a href="/app/reports/financial" class="flex items-center gap-2 hover:text-primary-600 transition-colors">
                                    <i class="fas fa-chart-line text-xs" aria-hidden="true"></i>
                                    Raporlama                                </a>
                            </li>
                                            </ul>
                            </div>

            <div>
                <p class="text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400 font-semibold mb-4">
                    Kaynaklar                </p>
                                    <ul class="space-y-2 text-sm text-slate-600 dark:text-slate-300">
                                                                                <li>
                                <a href="/app/MANUAL_TEST_CHECKLIST.md" target="_blank" rel="noopener" class="flex items-center gap-2 hover:text-primary-600 transition-colors">
                                    <i class="fas fa-clipboard-check text-xs" aria-hidden="true"></i>
                                    Manuel Test Listesi                                </a>
                            </li>
                                                                                <li>
                                <a href="/app/UX_IMPLEMENTATION_GUIDE.md" target="_blank" rel="noopener" class="flex items-center gap-2 hover:text-primary-600 transition-colors">
                                    <i class="fas fa-drafting-compass text-xs" aria-hidden="true"></i>
                                    UX K─▒lavuzu                                </a>
                            </li>
                                                                                <li>
                                <a href="/app/DEPLOYMENT_CHECKLIST.md" target="_blank" rel="noopener" class="flex items-center gap-2 hover:text-primary-600 transition-colors">
                                    <i class="fas fa-rocket text-xs" aria-hidden="true"></i>
                                    Deploy Checklist                                </a>
                            </li>
                                            </ul>
                            </div>

            <div>
                <p class="text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400 font-semibold mb-4">Destek & ─░leti┼şim</p>
                <ul class="space-y-3 text-sm text-slate-600 dark:text-slate-300">
                    <li class="flex items-start gap-3">
                        <i class="fas fa-envelope text-primary-600 dark:text-primary-300 text-xs mt-1" aria-hidden="true"></i>
                        <div>
                            <span class="text-xs text-slate-500 dark:text-slate-400 block">E-posta</span>
                            <a href="mailto:destek@kuretemizlik.com" class="font-medium hover:text-primary-600 transition-colors">
                                destek@kuretemizlik.com                            </a>
                        </div>
                    </li>
                    <li class="flex items-start gap-3">
                        <i class="fas fa-phone text-primary-600 dark:text-primary-300 text-xs mt-1" aria-hidden="true"></i>
                        <div>
                            <span class="text-xs text-slate-500 dark:text-slate-400 block">├ça─şr─▒ Merkezi</span>
                            <a href="tel:+908500000000" class="font-medium hover:text-primary-600 transition-colors">
                                +90 850 000 0000                            </a>
                        </div>
                    </li>
                    <li class="flex items-start gap-3">
                        <i class="fas fa-clock text-primary-600 dark:text-primary-300 text-xs mt-1" aria-hidden="true"></i>
                        <div>
                            <span class="text-xs text-slate-500 dark:text-slate-400 block">Destek Saatleri</span>
                            Hafta i├ği 09:00 ÔÇô 18:00
                        </div>
                    </li>
                    <li class="flex items-start gap-3">
                        <i class="fas fa-location-dot text-primary-600 dark:text-primary-300 text-xs mt-1" aria-hidden="true"></i>
                        <div>
                            <span class="text-xs text-slate-500 dark:text-slate-400 block">Ofis</span>
                            ─░stanbul / Maslak Teknoloji Ofisi
                        </div>
                    </li>
                </ul>
            </div>

            <div>
                <p class="text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400 font-semibold mb-4">Sistem ├ûzeti</p>
                <ul class="space-y-3 text-sm text-slate-600 dark:text-slate-300">
                                                                    <li class="flex items-center justify-between gap-3">
                            <span>Aktif Rol</span>
                            <span class="footer-status-chip">Operasyon Uzman─▒</span>
                        </li>
                                                                    <li class="flex items-center justify-between gap-3">
                            <span>Kapsam</span>
                            <span class="footer-status-chip">Y├Ânetim Paneli</span>
                        </li>
                                                                    <li class="flex items-center justify-between gap-3">
                            <span>Sunucu Saati</span>
                            <span class="footer-status-chip">25.11.2025 14:51</span>
                        </li>
                                                                    <li class="flex items-center justify-between gap-3">
                            <span>Zaman Dilimi</span>
                            <span class="footer-status-chip">Europe/Istanbul</span>
                        </li>
                                                                    <li class="flex items-center justify-between gap-3">
                            <span>├çoklu ┼Şirket Filtre</span>
                            <span class="footer-status-chip">T├╝m├╝</span>
                        </li>
                                                                    <li class="flex items-center justify-between gap-3">
                            <span>Aktif Kullan─▒c─▒</span>
                            <span class="footer-status-chip">test_operator</span>
                        </li>
                                                                    <li class="flex items-center justify-between gap-3">
                            <span>Performans Hedefi</span>
                            <span class="footer-status-chip">&lt; 200 ms</span>
                        </li>
                                    </ul>
            </div>
        </div>

        <div class="border-t border-gray-200 dark:border-gray-800 mt-10 pt-6 footer-meta">
            <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                <div>
                    <p class="text-sm text-slate-600 dark:text-slate-300">
                        &copy; 2025 K├╝re Temizlik. T├╝m haklar─▒ sakl─▒d─▒r.
                    </p>
                    <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">
                        Operasyonel m├╝kemmelik program─▒ kapsam─▒nda d├╝zenli g├╝venlik taramalar─▒ ve y├╝k testleri uygulan─▒r.
                    </p>
                </div>
                <div class="flex flex-wrap items-center gap-3 text-sm text-slate-600 dark:text-slate-300 footer-links">
                    <a href="/app/privacy-policy" class="hover:text-primary-600 transition-colors">Gizlilik Politikas─▒</a>
                    <span class="hidden md:inline" aria-hidden="true">ÔÇó</span>
                    <a href="/app/terms-of-use" class="hover:text-primary-600 transition-colors">Kullan─▒m ┼Şartlar─▒</a>
                    <span class="hidden md:inline" aria-hidden="true">ÔÇó</span>
                    <a href="/app/status" class="hover:text-primary-600 transition-colors">Sistem Durumu</a>
                </div>
            </div>
            <div class="flex flex-wrap items-center gap-2 md:gap-3 mt-4 text-xs text-slate-600 dark:text-slate-300 footer-metrics" aria-live="polite">
                <span id="sb-cache-foot" class="footer-status-chip">Cache: ├Âl├ğ├╝l├╝yor...</span>
                <span id="sb-db-foot" class="footer-status-chip">DB: ├Âl├ğ├╝l├╝yor...</span>
                <span id="sb-disk-foot" class="footer-status-chip">Disk: ├Âl├ğ├╝l├╝yor...</span>
                <span id="sb-queue-foot" class="footer-status-chip">Queue: ├Âl├ğ├╝l├╝yor...</span>
            </div>
        </div>
    </div>
</footer>
        
    <!-- Floating Action Button (Mobile) -->
        <!-- ===== KOZMOS_OPERATOR_READONLY: hide floating action button for operator (begin) -->
        <!-- ===== KOZMOS_OPERATOR_READONLY: hide floating action button for operator (end) -->
    
    <!-- Scripts -->
    <script>
        // Auto-hide flash messages
        document.addEventListener('DOMContentLoaded', function() {
            const flashMessages = document.querySelectorAll('.flash-message, .bg-green-50.border.border-green-200, .bg-red-50.border.border-red-200');
            flashMessages.forEach(function(message) {
                setTimeout(function() {
                    message.style.transition = 'opacity 0.5s';
                    message.style.opacity = '0';
                    setTimeout(function() {
                        message.remove();
                    }, 500);
                }, 10000); // 10 saniye olarak art─▒r─▒ld─▒
            });
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileMenuButton = event.target.closest('[onclick*="toggleMobileMenu"]');
            
            if (mobileMenu && !mobileMenu.contains(event.target) && !mobileMenuButton) {
                mobileMenu.style.display = 'none';
            }
        });
        
        // Global loading functions
        window.showGlobalLoading = function() {
            const overlay = document.getElementById('globalLoading');
            if (overlay) {
                overlay.classList.remove('hidden');
                overlay.classList.add('flex');
            }
        };
        
        window.hideGlobalLoading = function() {
            const overlay = document.getElementById('globalLoading');
            if (overlay) {
                overlay.classList.add('hidden');
                overlay.classList.remove('flex');
            }
        };
    </script>

    <!-- Global Loading Overlay -->
    <div id="globalLoading" class="fixed inset-0 bg-black bg-opacity-30 z-50 hidden items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-strong p-6 flex items-center space-x-3">
            <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"></div>
            <span class="text-gray-700 dark:text-gray-300">Y├╝kleniyor...</span>
        </div>
    </div>

        <!-- Modern Confirmation Dialog -->
    
<!-- Modern Confirmation Dialog -->
<div x-data="confirmationDialog()" 
     x-show="show" 
     x-transition:enter="transition ease-out duration-300"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition ease-in duration-200"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     class="fixed inset-0 z-50 overflow-y-auto"
     style="display: none;"
     @keydown.escape="cancel()">
    
    <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <!-- Backdrop -->
        <div class="fixed inset-0 bg-gray-900/50 backdrop-blur-sm transition-opacity" @click="cancel()"></div>
        
        <!-- Dialog -->
        <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-2xl text-left overflow-hidden shadow-strong transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
            <div class="bg-white dark:bg-gray-800 px-6 pt-6 pb-4 sm:p-8 sm:pb-6">
                <div class="sm:flex sm:items-start">
                    <!-- Icon -->
                    <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-xl bg-red-100 dark:bg-red-900/20 sm:mx-0 sm:h-10 sm:w-10">
                        <i class="fas fa-exclamation-triangle text-red-600 dark:text-red-400 text-lg"></i>
                    </div>
                    
                    <!-- Content -->
                    <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2" x-text="title">
                            Onay Gerekli
                        </h3>
                        <div class="mt-2">
                            <p class="text-sm text-gray-500 dark:text-gray-400" x-text="message">
                                Bu i┼şlemi ger├ğekle┼ştirmek istedi─şinizden emin misiniz?
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Actions -->
            <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4 sm:px-8 sm:flex sm:flex-row-reverse gap-3">
                <button type="button" 
                        @click="confirm()"
                        class="w-full inline-flex justify-center items-center px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow-soft hover:shadow-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 sm:ml-3 sm:w-auto">
                    <i class="fas fa-check mr-2"></i>
                    <span x-text="confirmText">Evet, Sil</span>
                </button>
                <button type="button" 
                        @click="cancel()"
                        class="mt-3 w-full inline-flex justify-center items-center px-6 py-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 font-semibold rounded-lg border border-gray-300 dark:border-gray-500 shadow-soft hover:shadow-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 sm:mt-0 sm:w-auto">
                    <i class="fas fa-times mr-2"></i>
                    <span x-text="cancelText">─░ptal</span>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
function confirmationDialog() {
    return {
        show: false,
        title: 'Onay Gerekli',
        message: 'Bu i┼şlemi ger├ğekle┼ştirmek istedi─şinizden emin misiniz?',
        confirmText: 'Evet, Sil',
        cancelText: '─░ptal',
        onConfirm: null,
        onCancel: null,
        
        init() {
            // Global function to show confirmation dialog
            window.showConfirmation = (options) => {
                this.title = options.title || 'Onay Gerekli';
                this.message = options.message || 'Bu i┼şlemi ger├ğekle┼ştirmek istedi─şinizden emin misiniz?';
                this.confirmText = options.confirmText || 'Evet, Sil';
                this.cancelText = options.cancelText || '─░ptal';
                this.onConfirm = options.onConfirm || null;
                this.onCancel = options.onCancel || null;
                this.show = true;
                
                // Focus management
                this.$nextTick(() => {
                    const confirmButton = this.$el.querySelector('button[type="button"]:first-of-type');
                    if (confirmButton) {
                        confirmButton.focus();
                    }
                });
            };
        },
        
        confirm() {
            if (this.onConfirm && typeof this.onConfirm === 'function') {
                this.onConfirm();
            }
            this.show = false;
        },
        
        cancel() {
            if (this.onCancel && typeof this.onCancel === 'function') {
                this.onCancel();
            }
            this.show = false;
        }
    };
}
</script>
    
    <!-- Modern Alert Dialog -->
    
<!-- Modern Alert Dialog -->
<div x-data="alertDialog()" 
     x-show="show" 
     x-transition:enter="transition ease-out duration-300"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition ease-in duration-200"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     class="fixed inset-0 z-50 overflow-y-auto"
     style="display: none;"
     @keydown.escape="close()">
    
    <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <!-- Backdrop -->
        <div class="fixed inset-0 bg-gray-900/50 backdrop-blur-sm transition-opacity" @click="close()"></div>
        
        <!-- Dialog -->
        <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-2xl text-left overflow-hidden shadow-strong transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
            <div class="bg-white dark:bg-gray-800 px-6 pt-6 pb-4 sm:p-8 sm:pb-6">
                <div class="sm:flex sm:items-start">
                    <!-- Icon -->
                    <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-xl sm:mx-0 sm:h-10 sm:w-10"
                         :class="iconClass">
                        <i class="fas text-lg" :class="iconName"></i>
                    </div>
                    
                    <!-- Content -->
                    <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                        <h3 class="text-xl font-bold mb-2" :class="titleClass" x-text="title">
                            Bilgi
                        </h3>
                        <div class="mt-2">
                            <p class="text-sm text-gray-500 dark:text-gray-400" x-text="message">
                                Mesaj burada g├Âr├╝necek.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Actions -->
            <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4 sm:px-8 sm:flex sm:flex-row-reverse">
                <button type="button" 
                        @click="close()"
                        class="w-full inline-flex justify-center items-center px-6 py-3 font-semibold rounded-lg shadow-soft hover:shadow-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 sm:ml-3 sm:w-auto"
                        :class="buttonClass">
                    <i class="fas fa-check mr-2"></i>
                    <span x-text="buttonText">Tamam</span>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
function alertDialog() {
    return {
        show: false,
        title: 'Bilgi',
        message: 'Mesaj burada g├Âr├╝necek.',
        type: 'info', // info, success, warning, error
        buttonText: 'Tamam',
        onClose: null,
        
        get iconClass() {
            const classes = {
                'info': 'bg-blue-100 dark:bg-blue-900/20',
                'success': 'bg-green-100 dark:bg-green-900/20',
                'warning': 'bg-yellow-100 dark:bg-yellow-900/20',
                'error': 'bg-red-100 dark:bg-red-900/20'
            };
            return classes[this.type] || classes['info'];
        },
        
        get iconName() {
            const icons = {
                'info': 'fa-info-circle text-blue-600 dark:text-blue-400',
                'success': 'fa-check-circle text-green-600 dark:text-green-400',
                'warning': 'fa-exclamation-triangle text-yellow-600 dark:text-yellow-400',
                'error': 'fa-times-circle text-red-600 dark:text-red-400'
            };
            return icons[this.type] || icons['info'];
        },
        
        get titleClass() {
            const classes = {
                'info': 'text-blue-900 dark:text-blue-100',
                'success': 'text-green-900 dark:text-green-100',
                'warning': 'text-yellow-900 dark:text-yellow-100',
                'error': 'text-red-900 dark:text-red-100'
            };
            return classes[this.type] || classes['info'];
        },
        
        get buttonClass() {
            const classes = {
                'info': 'bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500',
                'success': 'bg-green-600 hover:bg-green-700 text-white focus:ring-green-500',
                'warning': 'bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500',
                'error': 'bg-red-600 hover:bg-red-700 text-white focus:ring-red-500'
            };
            return classes[this.type] || classes['info'];
        },
        
        init() {
            // Global function to show alert dialog
            window.showAlert = (options) => {
                this.title = options.title || 'Bilgi';
                this.message = options.message || 'Mesaj burada g├Âr├╝necek.';
                this.type = options.type || 'info';
                this.buttonText = options.buttonText || 'Tamam';
                this.onClose = options.onClose || null;
                this.show = true;
                
                // Focus management
                this.$nextTick(() => {
                    const button = this.$el.querySelector('button[type="button"]');
                    if (button) {
                        button.focus();
                    }
                });
            };
        },
        
        close() {
            if (this.onClose && typeof this.onClose === 'function') {
                this.onClose();
            }
            this.show = false;
        }
    };
}
</script>

    <!-- Command Palette Modal -->
    <div id="cmdk" class="fixed inset-0 z-[10001] hidden">
        <div class="absolute inset-0 bg-black/30" data-cmdk-close></div>
        <div class="mx-auto mt-20 max-w-2xl rounded-xl shadow-strong overflow-hidden bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700">
            <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex items-center">
                <i class="fas fa-magnifying-glass text-gray-400 mr-2"></i>
                <input id="cmdk-input" type="text" class="w-full bg-transparent outline-none text-sm text-gray-800 dark:text-gray-100" placeholder="Ara veya komut yaz─▒n... (├ûrn: yeni s├Âzle┼şme, m├╝┼şteri bul)" autocomplete="off">
                <span class="ml-3 text-[10px] text-gray-500">Esc</span>
            </div>
            <div id="cmdk-results" class="max-h-80 overflow-y-auto">
                <div class="p-4 text-sm text-gray-500 dark:text-gray-400">─░pu├ğlar─▒: ÔÇ£yeni i┼şÔÇØ, ÔÇ£m├╝┼şteri: aliÔÇØ, ÔÇ£s├Âzle┼şme olu┼şturÔÇØ</div>
            </div>
        </div>
    </div>

    <script>
    // Status bar metrics (lightweight)
    (function(){
        const $cache = document.getElementById('sb-cache');
        const $db = document.getElementById('sb-db');
        const $disk = document.getElementById('sb-disk');
        const $queue = document.getElementById('sb-queue');
        const $cacheFoot = document.getElementById('sb-cache-foot');
        const $dbFoot = document.getElementById('sb-db-foot');
        const $diskFoot = document.getElementById('sb-disk-foot');
        const $queueFoot = document.getElementById('sb-queue-foot');
        async function loadMetrics(){
            try{
                const res = await fetch('/app/performance/metrics', { headers: {'X-CSRF-Token': '3a105ef969e8ed449246b6eb664eaff8c38d4137bea5204bf2391332a1317f3d'} });
                if(!res.ok) return;
                const data = await res.json();
                const hit = Math.round((data.cache?.hit_ratio ?? data.cache?.cache_hit_ratio ?? 0.85) * 100);
                const avg = data.queries?.slow_queries?.length ? Math.round((data.queries.slow_queries[0]?.duration_ms ?? 50)) : Math.round((50));
                const diskPct = data.system?.disk_usage?.percentage ?? 0;
                const cacheLabel = `Cache: ${hit}%`;
                const dbLabel = `DB: ~${avg}ms`;
                const diskLabel = `Disk: ${diskPct}%`;
                const queueLabel = 'Queue: ok';
                $cache && ($cache.textContent = cacheLabel);
                $db && ($db.textContent = dbLabel);
                $disk && ($disk.textContent = diskLabel);
                $queue && ($queue.textContent = queueLabel);
                $cacheFoot && ($cacheFoot.textContent = cacheLabel);
                $dbFoot && ($dbFoot.textContent = dbLabel);
                $diskFoot && ($diskFoot.textContent = diskLabel);
                $queueFoot && ($queueFoot.textContent = queueLabel);
            }catch(e){ /* silent */ }
        }
        // Performance: Delay metrics loading to avoid blocking initial render
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(loadMetrics, 1000);
            });
        } else {
            setTimeout(loadMetrics, 1000);
        }
        setInterval(loadMetrics, 30000);

        // Notification center (desktop + mobile unified)
        const notifEndpoints = {
            list: '/app/api/notifications/list',
            markAll: '/app/api/notifications/mark-all-read',
            mark: '/app/api/notifications/mark-read'
        };
        const csrfToken = '3a105ef969e8ed449246b6eb664eaff8c38d4137bea5204bf2391332a1317f3d';

        const escapeHtml = (value = '') => {
            const lookup = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#39;',
            };
            return value.toString().replace(/[&<>"']/g, char => lookup[char] || char);
        };

        const emptyStateMarkup = '<div class="notification-panel__empty"><div class="notification-panel__empty-icon"><i class="fas fa-bell-slash"></i></div><div class="notification-panel__empty-text">Yeni bildirim yok</div><div class="notification-panel__empty-subtext">T├╝m bildirimleriniz burada g├Âr├╝necek</div></div>';
        const errorStateMarkup = '<div class="notification-panel__empty"><div class="notification-panel__empty-icon"><i class="fas fa-exclamation-triangle"></i></div><div class="notification-panel__empty-text">Y├╝klenemedi</div><div class="notification-panel__empty-subtext">L├╝tfen tekrar deneyin</div></div>';

        const renderNotificationItems = (items) => {

            if(!Array.isArray(items) || items.length === 0) {

                return emptyStateMarkup;

            }

            return items.map(function(n){

                const type = n.type || 'ops';

                const typeClass = type === 'critical'

                    ? 'notification-item--critical'

                    : (type === 'system' ? 'notification-item--system' : 'notification-item--ops');

                const readCls = n.read ? 'notification-item--read' : '';

                const key = n.key || '';

                const icon = n.icon || (type === 'critical'

                    ? 'fa-exclamation-triangle'

                    : (type === 'system' ? 'fa-hdd' : 'fa-info-circle'));

                const badge = n.read ? '' : '<span class="notification-item__badge"><span class="notification-item__badge-dot"></span><span>Yeni</span></span>';

                const meta = n.meta ? '<div class="notification-item__meta" title="'+escapeHtml(n.meta)+'">'+escapeHtml(n.meta)+'</div>' : '';

                const title = escapeHtml(n.text || '');

                const safeKey = escapeHtml(key);

                const hrefAttr = n.href ? ' data-href="'+escapeHtml(n.href)+'"' : '';

                const unreadToggle = key ? '<button class="notification-item__mark-toggle" data-action="mark-unread" type="button" title="Okunmad─▒ olarak i┼şaretle"><i class="fas fa-rotate-left"></i></button>' : '';

                return `

                    <div class="notification-item ${typeClass} ${readCls}" data-key="${safeKey}" data-type="${type}"${hrefAttr} data-read="${n.read ? 'true' : 'false'}" tabindex="0" role="button">

                        <div class="notification-item__glow"></div>

                        ${unreadToggle}

                        <div class="notification-item__content">

                            <div class="notification-item__icon-wrapper">

                                <div class="notification-item__icon-bg"></div>

                                <i class="fas ${icon} notification-item__icon"></i>

                            </div>

                            <div class="notification-item__body">

                                <div class="notification-item__header">

                                    ${badge}

                                    <div class="notification-item__title" title="${title}">${title}</div>

                                </div>

                                ${meta}

                            </div>

                        </div>

                    </div>

                `;

            }).join('');

        };

        function updateBadge(targetId, count, chipId) {
            const text = count > 0 ? (count > 99 ? '99+' : count) : '';
            [targetId, chipId].forEach(id => {
                if(!id) { return; }
                const el = document.getElementById(id);
                if(!el) { return; }
                if(count <= 0) {
                    el.classList.add('hidden');
                    el.textContent = '';
                } else {
                    el.classList.remove('hidden');
                    el.textContent = text;
                }
            });
        }

        function setBodyLock(state) {
            document.body.classList.toggle('notification-panel-open', !!state);
        }

        function createNotificationLoader(listEl) {
            let isLoading = false;
            return async function(showSpinner = true, preserveContent = true) {
                if(!listEl || isLoading) { return; }
                isLoading = true;
                const original = listEl.innerHTML;

                if(showSpinner && preserveContent && listEl.children.length > 0) {
                    listEl.setAttribute('data-loading', 'true');
                }

                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 10000);
                    const res = await fetch(`${notifEndpoints.list}?t=${Date.now()}`, { cache: 'no-store', signal: controller.signal });
                    clearTimeout(timeoutId);

                    if(!res.ok) {
                        throw new Error('HTTP '+res.status);
                    }

                    const data = await res.json();
                    const items = Array.isArray(data?.data) ? data.data : [];
                    listEl.innerHTML = renderNotificationItems(items);
                    const unreadCount = items.filter(item => !item.read).length;
                    updateBadge('notif-badge', unreadCount, 'notif-count-chip');
                    updateBadge('notif-badge-mobile', unreadCount, 'notif-count-chip-mobile');
                } catch(err) {
                    if(!preserveContent) {
                        listEl.innerHTML = errorStateMarkup;
                    }
                } finally {
                    listEl.removeAttribute('data-loading');
                    isLoading = false;
                }
            };
        }

        const listEl = document.getElementById('notif-list');
        const listElMobile = document.getElementById('notif-list-mobile');
        const loadNotifs = createNotificationLoader(listEl);
        const loadNotifsMobile = createNotificationLoader(listElMobile);

        async function refreshNotifications(preserveContent = true) {
            await Promise.all([
                loadNotifs(false, preserveContent),
                loadNotifsMobile(false, preserveContent)
            ]);
        }

        async function markNotification(key, state = 'read', { refresh = true } = {}) {
            if(!key) { return false; }
            try{
                const body = new URLSearchParams({ key, state });
                const res = await fetch(notifEndpoints.mark, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/x-www-form-urlencoded','X-CSRF-Token': csrfToken},
                    body: body.toString()
                });
                if(!res.ok) {
                    throw new Error('HTTP '+res.status);
                }
                if(refresh) {
                    await refreshNotifications(false);
                }
                return true;
            }catch(err){
                console.warn('Notification mark failed', err);
                return false;
            }
        }

        function handleNotificationActivation(item, event) {
            if(!item) { return; }
            const notifKey = item.getAttribute('data-key');
            const href = item.getAttribute('data-href');
            const isRead = item.dataset.read === 'true';
            if(notifKey && !isRead){
                item.dataset.read = 'true';
                item.classList.add('notification-item--read');
                const shouldRefresh = !href;
                markNotification(notifKey, 'read', { refresh: shouldRefresh }).then(success => {
                    if(!success){
                        item.dataset.read = 'false';
                        item.classList.remove('notification-item--read');
                    }
                });
            }
            if(href){
                const openNew = event && (event.metaKey || event.ctrlKey || event.button === 1);
                if(openNew){
                    window.open(href, '_blank', 'noopener');
                } else {
                    window.location.href = href;
                }
            }
        }

        function attachNotificationInteractions(targetList) {
            if(!targetList) { return; }
            targetList.addEventListener('click', function(e){
                const unreadBtn = e.target.closest('[data-action="mark-unread"]');
                if(unreadBtn){
                    e.preventDefault();
                    e.stopPropagation();
                    const parent = unreadBtn.closest('.notification-item');
                    if(!parent) { unreadBtn.disabled = false; return; }
                    const notifKey = parent.getAttribute('data-key');
                    if(!notifKey) { return; }
                    unreadBtn.disabled = true;
                    markNotification(notifKey, 'unread', { refresh: true }).then(success => {
                        if(success){
                            parent.dataset.read = 'false';
                            parent.classList.remove('notification-item--read');
                        }
                    }).finally(() => {
                        unreadBtn.disabled = false;
                    });
                    return;
                }
                const item = e.target.closest('.notification-item');
                if(!item) { return; }
                handleNotificationActivation(item, e);
            });

            targetList.addEventListener('keydown', function(e){
                if(e.key !== 'Enter' && e.key !== ' ') { return; }
                const item = e.target.closest('.notification-item');
                if(!item) { return; }
                e.preventDefault();
                handleNotificationActivation(item, e);
            });

            targetList.addEventListener('auxclick', function(e){
                if(e.button !== 1) { return; }
                const item = e.target.closest('.notification-item');
                if(!item) { return; }
                e.preventDefault();
                handleNotificationActivation(item, e);
            });
        }

        const configs = [
            { button: document.getElementById('notif-button'), panel: document.getElementById('notif-menu'), variant: 'desktop' },
            { button: document.getElementById('notif-button-mobile'), panel: document.getElementById('notif-menu-mobile'), variant: 'mobile' },
        ].filter(cfg => cfg.button && cfg.panel);

        function closeAllPanels() {
            configs.forEach(cfg => {
                cfg.panel.classList.add('hidden');
                cfg.panel.dataset.state = 'closed';
                cfg.button.setAttribute('aria-expanded', 'false');
            });
            setBodyLock(false);
        }

        function openPanel(cfg) {
            configs.forEach(other => {
                if(other === cfg) { return; }
                other.panel.classList.add('hidden');
                other.panel.dataset.state = 'closed';
                other.button.setAttribute('aria-expanded', 'false');
            });
            cfg.panel.classList.remove('hidden');
            cfg.panel.dataset.state = 'open';
            cfg.button.setAttribute('aria-expanded', 'true');
            setBodyLock(cfg.variant === 'mobile');
        }

        configs.forEach(cfg => {
            cfg.panel.dataset.state = 'closed';
            cfg.button.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const isOpen = !cfg.panel.classList.contains('hidden');
                if(isOpen) {
                    closeAllPanels();
                } else {
                    openPanel(cfg);
                    if(cfg.variant === 'mobile') {
                        loadNotifsMobile();
                    } else {
                        loadNotifs();
                    }
                }
            });
            cfg.panel.addEventListener('click', function(e){ e.stopPropagation(); });
            const scrim = cfg.panel.querySelector('.notification-panel__scrim');
            scrim && scrim.addEventListener('click', function(e){
                e.preventDefault();
                closeAllPanels();
            });
        });

        if(configs.length){
            document.addEventListener('click', function(e){
                const clickInside = configs.some(cfg => cfg.panel.contains(e.target) || cfg.button.contains(e.target));
                if(!clickInside) {
                    closeAllPanels();
                }
            });
            document.addEventListener('keydown', function(e){
                if(e.key === 'Escape'){
                    closeAllPanels();
                }
            });
        }

        function attachMarkAllHandler(button){
            if(!button) { return; }
            button.addEventListener('click', async function(e){
                e.preventDefault();
                e.stopPropagation();
                try{
                    const res = await fetch(notifEndpoints.markAll, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json','X-CSRF-Token': csrfToken},
                    });
                    if(res.ok){
                        await refreshNotifications(false);
                    }
                }catch(err){ /* silent */ }
            });
        }
        attachMarkAllHandler(document.getElementById('notif-mark-all'));
        attachMarkAllHandler(document.getElementById('notif-mark-all-mobile'));

        attachNotificationInteractions(listEl);
        attachNotificationInteractions(listElMobile);

    })();
    </script>

    <!-- PWA Service Worker Registration (guarded - SSL errors won't affect UI) -->
    <script>
    (function(){
        try {
            // Auth helper: optional refresh endpoint and VAPID public key
            window.AUTH_REFRESH_URL = '/app/api/auth/refresh';
            window.VAPID_PUBLIC_KEY = '';
            // Expose fetchAuth if auth.js is present
            (function injectAuth(){
                var s = document.createElement('script');
                s.src = '/app/assets/js/auth.js' + '?v=' + (window.assetVersion || '1');
                s.defer = true;
                document.head && document.head.appendChild(s);
            })();
            // Inject manifest link if not present
            (function ensureManifest(){
                var has = document.querySelector('link[rel="manifest"]');
                if (!has) {
                    var link = document.createElement('link');
                    link.rel = 'manifest';
                    link.href = '/app/assets/manifest.webmanifest';
                    document.head && document.head.appendChild(link);
                }
            })();

            // Service Worker disabled (ROUND 15) - application does not use PWA/offline features
            // Unregister any existing Service Workers silently
            (function unregisterServiceWorkers(){
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.getRegistrations().then(function(registrations) {
                        for(var i = 0; i < registrations.length; i++) {
                            registrations[i].unregister().catch(function() {
                                // Silent failure - SW cleanup failed, but don't break page
                            });
                        }
                    }).catch(function() {
                        // Silent failure - getRegistrations failed, but don't break page
                    });
                }
            })();
        } catch (e) {
            // Silently ignore errors
        }
    })();
    </script>






</body>
</html>

Fatal error: Maximum execution time of 30 seconds exceeded in C:\X\Yaz─▒l─▒m\Alastyr_ftp\kuretemizlik.com\app\src\Lib\Auth.php on line 38
Error: Maximum execution time of 30 seconds exceeded in C:\X\Yaz─▒l─▒m\Alastyr_ftp\kuretemizlik.com\app\src\Lib\Auth.php on line 38
